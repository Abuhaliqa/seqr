(self.webpackChunkseqr=self.webpackChunkseqr||[]).push([[411],{37345:function(t,e,n){"use strict";n.d(e,{oh:function(){return m},Kn:function(){return l.Z},eF:function(){return l.D}});var r=n(3839),i=n(42274),a=n(69607),o=n(5130),s=n(92992),l=n(14827),u=n(12828);function c(t){return function(){return t}}function h(t,e,n,r,i,a,o,s,l,u){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=a,this.y=o,this.dx=s,this.dy=l,this._=u}function f(){return!i.B.ctrlKey&&!i.B.button}function d(){return this.parentNode}function p(t){return null==t?{x:i.B.x,y:i.B.y}:t}function _(){return navigator.maxTouchPoints||"ontouchstart"in this}function m(){var t,e,n,m,y=f,g=d,v=p,x=_,w={},b=(0,r.Z)("start","drag","end"),z=0,k=0;function A(t){t.on("mousedown.drag",E).filter(x).on("touchstart.drag",S).on("touchmove.drag",N).on("touchend.drag touchcancel.drag",O).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function E(){if(!m&&y.apply(this,arguments)){var r=Z("mouse",g.apply(this,arguments),a.Z,this,arguments);r&&((0,o.Z)(i.B.view).on("mousemove.drag",T,!0).on("mouseup.drag",M,!0),(0,l.Z)(i.B.view),(0,u.r)(),n=!1,t=i.B.clientX,e=i.B.clientY,r("start"))}}function T(){if((0,u.Z)(),!n){var r=i.B.clientX-t,a=i.B.clientY-e;n=r*r+a*a>k}w.mouse("drag")}function M(){(0,o.Z)(i.B.view).on("mousemove.drag mouseup.drag",null),(0,l.D)(i.B.view,n),(0,u.Z)(),w.mouse("end")}function S(){if(y.apply(this,arguments)){var t,e,n=i.B.changedTouches,r=g.apply(this,arguments),a=n.length;for(t=0;t<a;++t)(e=Z(n[t].identifier,r,s.Z,this,arguments))&&((0,u.r)(),e("start"))}}function N(){var t,e,n=i.B.changedTouches,r=n.length;for(t=0;t<r;++t)(e=w[n[t].identifier])&&((0,u.Z)(),e("drag"))}function O(){var t,e,n=i.B.changedTouches,r=n.length;for(m&&clearTimeout(m),m=setTimeout((function(){m=null}),500),t=0;t<r;++t)(e=w[n[t].identifier])&&((0,u.r)(),e("end"))}function Z(t,e,n,r,a){var o,s,l,u=n(e,t),c=b.copy();if((0,i._H)(new h(A,"beforestart",o,t,z,u[0],u[1],0,0,c),(function(){return null!=(i.B.subject=o=v.apply(r,a))&&(s=o.x-u[0]||0,l=o.y-u[1]||0,!0)})))return function f(d){var p,_=u;switch(d){case"start":w[t]=f,p=z++;break;case"end":delete w[t],--z;case"drag":u=n(e,t),p=z}(0,i._H)(new h(A,d,o,t,p,u[0]+s,u[1]+l,u[0]-_[0],u[1]-_[1],c),c.apply,c,[d,r,a])}}return A.filter=function(t){return arguments.length?(y="function"==typeof t?t:c(!!t),A):y},A.container=function(t){return arguments.length?(g="function"==typeof t?t:c(t),A):g},A.subject=function(t){return arguments.length?(v="function"==typeof t?t:c(t),A):v},A.touchable=function(t){return arguments.length?(x="function"==typeof t?t:c(!!t),A):x},A.on=function(){var t=b.on.apply(b,arguments);return t===b?A:t},A.clickDistance=function(t){return arguments.length?(k=(t=+t)*t,A):Math.sqrt(k)},A}h.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t}},14827:function(t,e,n){"use strict";n.d(e,{Z:function(){return a},D:function(){return o}});var r=n(5130),i=n(12828);function a(t){var e=t.document.documentElement,n=(0,r.Z)(t).on("dragstart.drag",i.Z,!0);"onselectstart"in e?n.on("selectstart.drag",i.Z,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function o(t,e){var n=t.document.documentElement,a=(0,r.Z)(t).on("dragstart.drag",null);e&&(a.on("click.drag",i.Z,!0),setTimeout((function(){a.on("click.drag",null)}),0)),"onselectstart"in n?a.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}},12828:function(t,e,n){"use strict";n.d(e,{r:function(){return i},Z:function(){return a}});var r=n(42274);function i(){r.B.stopImmediatePropagation()}function a(){r.B.preventDefault(),r.B.stopImmediatePropagation()}},47367:function(t,e,n){"use strict";function r(t,e){return t.parent===e.parent?1:2}function i(t,e){return t+e.x}function a(t,e){return Math.max(t,e.y)}function o(){var t=r,e=1,n=1,o=!1;function s(r){var s,l=0;r.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(i,0)/t.length}(n),e.y=function(t){return 1+t.reduce(a,0)}(n)):(e.x=s?l+=t(e,s):0,e.y=0,s=e)}));var u=function(t){for(var e;e=t.children;)t=e[0];return t}(r),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(r),h=u.x-t(u,c)/2,f=c.x+t(c,u)/2;return r.eachAfter(o?function(t){t.x=(t.x-r.x)*e,t.y=(r.y-t.y)*n}:function(t){t.x=(t.x-h)/(f-h)*e,t.y=(1-(r.y?t.y/r.y:1))*n})}return s.separation=function(e){return arguments.length?(t=e,s):t},s.size=function(t){return arguments.length?(o=!1,e=+t[0],n=+t[1],s):o?null:[e,n]},s.nodeSize=function(t){return arguments.length?(o=!0,e=+t[0],n=+t[1],s):o?[e,n]:null},s}function s(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function l(t,e){var n,r,i,a,o,s=new f(t),l=+t.value&&(s.value=t.value),c=[s];for(null==e&&(e=u);n=c.pop();)if(l&&(n.value=+n.data.value),(i=e(n.data))&&(o=i.length))for(n.children=new Array(o),a=o-1;a>=0;--a)c.push(r=n.children[a]=new f(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(h)}function u(t){return t.children}function c(t){t.data=t.data.data}function h(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function f(t){this.data=t,this.depth=this.height=0,this.parent=null}n.d(e,{ki:function(){return o},bT:function(){return l},P2:function(){return C},O1:function(){return p},jA:function(){return T},uK:function(){return P},QP:function(){return j},G_:function(){return J},pN:function(){return nt},wL:function(){return rt},LQ:function(){return F},eA:function(){return at},Km:function(){return $},E_:function(){return it},o$:function(){return et}}),f.prototype=l.prototype={constructor:f,count:function(){return this.eachAfter(s)},each:function(t){var e,n,r,i,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},eachAfter:function(t){for(var e,n,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return l(this).eachBefore(c)}};var d=Array.prototype.slice;function p(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(d.call(t))).length,a=[];r<i;)e=t[r],n&&y(n,e)?++r:(n=v(a=_(a,e)),r=0);return n}function _(t,e){var n,r;if(g(e,t))return[e];for(n=0;n<t.length;++n)if(m(e,t[n])&&g(x(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(m(x(t[n],t[r]),e)&&m(x(t[n],e),t[r])&&m(x(t[r],e),t[n])&&g(w(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function m(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function y(t,e){var n=t.r-e.r+1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function g(t,e){for(var n=0;n<e.length;++n)if(!y(t,e[n]))return!1;return!0}function v(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return x(t[0],t[1]);case 3:return w(t[0],t[1],t[2])}var e}function x(t,e){var n=t.x,r=t.y,i=t.r,a=e.x,o=e.y,s=e.r,l=a-n,u=o-r,c=s-i,h=Math.sqrt(l*l+u*u);return{x:(n+a+l/h*c)/2,y:(r+o+u/h*c)/2,r:(h+i+s)/2}}function w(t,e,n){var r=t.x,i=t.y,a=t.r,o=e.x,s=e.y,l=e.r,u=n.x,c=n.y,h=n.r,f=r-o,d=r-u,p=i-s,_=i-c,m=l-a,y=h-a,g=r*r+i*i-a*a,v=g-o*o-s*s+l*l,x=g-u*u-c*c+h*h,w=d*p-f*_,b=(p*x-_*v)/(2*w)-r,z=(_*m-p*y)/w,k=(d*v-f*x)/(2*w)-i,A=(f*y-d*m)/w,E=z*z+A*A-1,T=2*(a+b*z+k*A),M=b*b+k*k-a*a,S=-(E?(T+Math.sqrt(T*T-4*E*M))/(2*E):M/T);return{x:r+b+z*S,y:i+k+A*S,r:S}}function b(t,e,n){var r,i,a,o,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(i=e.r+n.r,i*=i,o=t.r+n.r,i>(o*=o)?(r=(u+o-i)/(2*u),a=Math.sqrt(Math.max(0,o/u-r*r)),n.x=t.x-r*s-a*l,n.y=t.y-r*l+a*s):(r=(u+i-o)/(2*u),a=Math.sqrt(Math.max(0,i/u-r*r)),n.x=e.x+r*s-a*l,n.y=e.y+r*l+a*s)):(n.x=e.x+n.r,n.y=e.y)}function z(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function k(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,a=(e.y*n.r+n.y*e.r)/r;return i*i+a*a}function A(t){this._=t,this.next=null,this.previous=null}function E(t){if(!(i=t.length))return 0;var e,n,r,i,a,o,s,l,u,c,h;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;b(n,e,r=t[2]),e=new A(e),n=new A(n),r=new A(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(s=3;s<i;++s){b(e._,n._,r=t[s]),r=new A(r),l=n.next,u=e.previous,c=n._.r,h=e._.r;do{if(c<=h){if(z(l._,r._)){n=l,e.next=n,n.previous=e,--s;continue t}c+=l._.r,l=l.next}else{if(z(u._,r._)){(e=u).next=n,n.previous=e,--s;continue t}h+=u._.r,u=u.previous}}while(l!==u.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,a=k(e);(r=r.next)!==n;)(o=k(r))<a&&(e=r,a=o);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=p(e),s=0;s<i;++s)(e=t[s]).x-=r.x,e.y-=r.y;return r.r}function T(t){return E(t),t}function M(t){return null==t?null:S(t)}function S(t){if("function"!=typeof t)throw new Error;return t}function N(){return 0}function O(t){return function(){return t}}function Z(t){return Math.sqrt(t.value)}function C(){var t=null,e=1,n=1,r=N;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(I(t)).eachAfter(D(r,.5)).eachBefore(L(1)):i.eachBefore(I(Z)).eachAfter(D(N,1)).eachAfter(D(r,i.r/Math.min(e,n))).eachBefore(L(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=M(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:O(+t),i):r},i}function I(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function D(t,e){return function(n){if(r=n.children){var r,i,a,o=r.length,s=t(n)*e||0;if(s)for(i=0;i<o;++i)r[i].r+=s;if(a=E(r),s)for(i=0;i<o;++i)r[i].r-=s;n.r=a+s}}}function L(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function B(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function F(t,e,n,r,i){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(r-e)/t.value;++s<l;)(a=o[s]).y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*u}function P(){var t=1,e=1,n=0,r=!1;function i(i){var a=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/a,i.eachBefore(function(t,e){return function(r){r.children&&F(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,a=r.y0,o=r.x1-n,s=r.y1-n;o<i&&(i=o=(i+o)/2),s<a&&(a=s=(a+s)/2),r.x0=i,r.y0=a,r.x1=o,r.y1=s}}(e,a)),r&&i.eachBefore(B),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i}var q={depth:-1},U={};function Y(t){return t.id}function R(t){return t.parentId}function j(){var t=Y,e=R;function n(n){var r,i,a,o,s,l,u,c=n.length,d=new Array(c),p={};for(i=0;i<c;++i)r=n[i],s=d[i]=new f(r),null!=(l=t(r,i,n))&&(l+="")&&(p[u="$"+(s.id=l)]=u in p?U:s);for(i=0;i<c;++i)if(s=d[i],null!=(l=e(n[i],i,n))&&(l+="")){if(!(o=p["$"+l]))throw new Error("missing: "+l);if(o===U)throw new Error("ambiguous: "+l);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=q,a.eachBefore((function(t){t.depth=t.parent.depth+1,--c})).eachBefore(h),a.parent=null,c>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=S(e),n):t},n.parentId=function(t){return arguments.length?(e=S(t),n):e},n}function H(t,e){return t.parent===e.parent?1:2}function G(t){var e=t.children;return e?e[0]:t.t}function V(t){var e=t.children;return e?e[e.length-1]:t.t}function X(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function K(t,e,n){return t.a.parent===e.parent?t.a:n}function W(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function J(){var t=H,e=1,n=1,r=null;function i(i){var l=function(t){for(var e,n,r,i,a,o=new W(t,0),s=[o];e=s.pop();)if(r=e._.children)for(e.children=new Array(a=r.length),i=a-1;i>=0;--i)s.push(n=e.children[i]=new W(r[i],i)),n.parent=e;return(o.parent=new W(null,0)).children=[o],o}(i);if(l.eachAfter(a),l.parent.m=-l.z,l.eachBefore(o),r)i.eachBefore(s);else{var u=i,c=i,h=i;i.eachBefore((function(t){t.x<u.x&&(u=t),t.x>c.x&&(c=t),t.depth>h.depth&&(h=t)}));var f=u===c?1:t(u,c)/2,d=f-u.x,p=e/(c.x+f+d),_=n/(h.depth||1);i.eachBefore((function(t){t.x=(t.x+d)*p,t.y=t.depth*_}))}return i}function a(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,a=i.length;--a>=0;)(e=i[a]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var a=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-a):e.z=a}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,a=e,o=e,s=n,l=a.parent.children[0],u=a.m,c=o.m,h=s.m,f=l.m;s=V(s),a=G(a),s&&a;)l=G(l),(o=V(o)).a=e,(i=s.z+h-a.z-u+t(s._,a._))>0&&(X(K(s,e,r),e,i),u+=i,c+=i),h+=s.m,u+=a.m,f+=l.m,c+=o.m;s&&!V(o)&&(o.t=s,o.m+=h-c),a&&!G(l)&&(l.t=a,l.m+=u-f,r=e)}return r}(e,i,e.parent.A||r[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}function $(t,e,n,r,i){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(i-n)/t.value;++s<l;)(a=o[s]).x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*u}W.prototype=Object.create(f.prototype);var Q=(1+Math.sqrt(5))/2;function tt(t,e,n,r,i,a){for(var o,s,l,u,c,h,f,d,p,_,m,y=[],g=e.children,v=0,x=0,w=g.length,b=e.value;v<w;){l=i-n,u=a-r;do{c=g[x++].value}while(!c&&x<w);for(h=f=c,m=c*c*(_=Math.max(u/l,l/u)/(b*t)),p=Math.max(f/m,m/h);x<w;++x){if(c+=s=g[x].value,s<h&&(h=s),s>f&&(f=s),m=c*c*_,(d=Math.max(f/m,m/h))>p){c-=s;break}p=d}y.push(o={value:c,dice:l<u,children:g.slice(v,x)}),o.dice?F(o,n,r,i,b?r+=u*c/b:a):$(o,n,r,b?n+=l*c/b:i,a),b-=c,v=x}return y}var et=function t(e){function n(t,n,r,i,a){tt(e,t,n,r,i,a)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Q);function nt(){var t=et,e=!1,n=1,r=1,i=[0],a=N,o=N,s=N,l=N,u=N;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(B),t}function h(e){var n=i[e.depth],r=e.x0+n,c=e.y0+n,h=e.x1-n,f=e.y1-n;h<r&&(r=h=(r+h)/2),f<c&&(c=f=(c+f)/2),e.x0=r,e.y0=c,e.x1=h,e.y1=f,e.children&&(n=i[e.depth+1]=a(e)/2,r+=u(e)-n,c+=o(e)-n,(h-=s(e)-n)<r&&(r=h=(r+h)/2),(f-=l(e)-n)<c&&(c=f=(c+f)/2),t(e,r,c,h,f))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],r=+t[1],c):[n,r]},c.tile=function(e){return arguments.length?(t=S(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(a="function"==typeof t?t:O(+t),c):a},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(o="function"==typeof t?t:O(+t),c):o},c.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:O(+t),c):s},c.paddingBottom=function(t){return arguments.length?(l="function"==typeof t?t:O(+t),c):l},c.paddingLeft=function(t){return arguments.length?(u="function"==typeof t?t:O(+t),c):u},c}function rt(t,e,n,r,i){var a,o,s=t.children,l=s.length,u=new Array(l+1);for(u[0]=o=a=0;a<l;++a)u[a+1]=o+=s[a].value;!function t(e,n,r,i,a,o,l){if(e>=n-1){var c=s[e];return c.x0=i,c.y0=a,c.x1=o,void(c.y1=l)}var h=u[e],f=r/2+h,d=e+1,p=n-1;for(;d<p;){var _=d+p>>>1;u[_]<f?d=_+1:p=_}f-u[d-1]<u[d]-f&&e+1<d&&--d;var m=u[d]-h,y=r-m;if(o-i>l-a){var g=(i*y+o*m)/r;t(e,d,m,i,a,g,l),t(d,n,y,g,a,o,l)}else{var v=(a*y+l*m)/r;t(e,d,m,i,a,o,v),t(d,n,y,i,v,o,l)}}(0,l,t.value,e,n,r,i)}function it(t,e,n,r,i){(1&t.depth?$:F)(t,e,n,r,i)}var at=function t(e){function n(t,n,r,i,a){if((o=t._squarify)&&o.ratio===e)for(var o,s,l,u,c,h=-1,f=o.length,d=t.value;++h<f;){for(l=(s=o[h]).children,u=s.value=0,c=l.length;u<c;++u)s.value+=l[u].value;s.dice?F(s,n,r,i,r+=(a-r)*s.value/d):$(s,n,r,n+=(i-n)*s.value/d,a),d-=s.value}else t._squarify=o=tt(e,t,n,r,i,a),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Q)},52508:function(t,e){"use strict";var n=Math.PI,r=2*n,i=1e-6,a=r-i;function o(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function s(){return new o}o.prototype=s.prototype={constructor:o,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,r,a,o){t=+t,e=+e,r=+r,a=+a,o=+o;var s=this._x1,l=this._y1,u=r-t,c=a-e,h=s-t,f=l-e,d=h*h+f*f;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(d>i)if(Math.abs(f*u-c*h)>i&&o){var p=r-s,_=a-l,m=u*u+c*c,y=p*p+_*_,g=Math.sqrt(m),v=Math.sqrt(d),x=o*Math.tan((n-Math.acos((m+d-y)/(2*g*v)))/2),w=x/v,b=x/g;Math.abs(w-1)>i&&(this._+="L"+(t+w*h)+","+(e+w*f)),this._+="A"+o+","+o+",0,0,"+ +(f*p>h*_)+","+(this._x1=t+b*u)+","+(this._y1=e+b*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,o,s,l,u){t=+t,e=+e,u=!!u;var c=(o=+o)*Math.cos(s),h=o*Math.sin(s),f=t+c,d=e+h,p=1^u,_=u?s-l:l-s;if(o<0)throw new Error("negative radius: "+o);null===this._x1?this._+="M"+f+","+d:(Math.abs(this._x1-f)>i||Math.abs(this._y1-d)>i)&&(this._+="L"+f+","+d),o&&(_<0&&(_=_%r+r),_>a?this._+="A"+o+","+o+",0,1,"+p+","+(t-c)+","+(e-h)+"A"+o+","+o+",0,1,"+p+","+(this._x1=f)+","+(this._y1=d):_>i&&(this._+="A"+o+","+o+",0,"+ +(_>=n)+","+p+","+(this._x1=t+o*Math.cos(l))+","+(this._y1=e+o*Math.sin(l))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}},e.Z=s},56164:function(t,e,n){"use strict";n.d(e,{Eb:function(){return d.Z},Ue:function(){return a},Du:function(){return r.Z},_H:function(){return z._H},B:function(){return z.B},I_:function(){return s},C2:function(){return u.Z},Jz:function(){return c.Z},uD:function(){return h.Z},aC:function(){return f.Z},Ys:function(){return i.Z},td:function(){return p.Z},f_:function(){return _.ZP},nZ:function(){return m.Z},UK:function(){return y.Z},oB:function(){return g.S},Fq:function(){return v.Z},W4:function(){return w},u9:function(){return b.Z}});var r=n(35e3),i=n(5130);function a(t){return(0,i.Z)((0,r.Z)(t).call(document.documentElement))}var o=0;function s(){return new l}function l(){this._="@"+(++o).toString(36)}l.prototype=s.prototype={constructor:l,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var u=n(40597),c=n(69607),h=n(60447),f=n(19030),d=n(47882),p=n(56070),_=n(73078),m=n(86408),y=n(43912),g=n(40721),v=n(92992),x=n(98861);function w(t,e){null==e&&(e=(0,x.Z)().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=(0,d.Z)(t,e[n]);return i}var b=n(58414),z=n(42274)},69607:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(98861),i=n(47882);function a(t){var e=(0,r.Z)();return e.changedTouches&&(e=e.changedTouches[0]),(0,i.Z)(t,e)}},47882:function(t,e,n){"use strict";function r(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}n.d(e,{Z:function(){return r}})},56070:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(73078);function i(t){return"string"==typeof t?new r.Y1([document.querySelectorAll(t)],[document.documentElement]):new r.Y1([null==t?[]:t],r.Jz)}},98861:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(42274);function i(){for(var t,e=r.B;t=e.sourceEvent;)e=t;return e}},92992:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(98861),i=n(47882);function a(t,e,n){arguments.length<3&&(n=e,e=(0,r.Z)().changedTouches);for(var a,o=0,s=e?e.length:0;o<s;++o)if((a=e[o]).identifier===n)return(0,i.Z)(t,a);return null}},45902:function(t,e,n){"use strict";n.d(e,{Z:function(){return l}});var r=n(52508),i=n(56297),a=n(41545),o=n(23780),s=n(32337);function l(){var t=s.x,e=null,n=(0,i.Z)(0),l=s.y,u=(0,i.Z)(!0),c=null,h=a.Z,f=null;function d(i){var a,o,s,d,p,_=i.length,m=!1,y=new Array(_),g=new Array(_);for(null==c&&(f=h(p=(0,r.Z)())),a=0;a<=_;++a){if(!(a<_&&u(d=i[a],a,i))===m)if(m=!m)o=a,f.areaStart(),f.lineStart();else{for(f.lineEnd(),f.lineStart(),s=a-1;s>=o;--s)f.point(y[s],g[s]);f.lineEnd(),f.areaEnd()}m&&(y[a]=+t(d,a,i),g[a]=+n(d,a,i),f.point(e?+e(d,a,i):y[a],l?+l(d,a,i):g[a]))}if(p)return f=null,p+""||null}function p(){return(0,o.Z)().defined(u).curve(h).context(c)}return d.x=function(n){return arguments.length?(t="function"==typeof n?n:(0,i.Z)(+n),e=null,d):t},d.x0=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.Z)(+e),d):t},d.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:(0,i.Z)(+t),d):e},d.y=function(t){return arguments.length?(n="function"==typeof t?t:(0,i.Z)(+t),l=null,d):n},d.y0=function(t){return arguments.length?(n="function"==typeof t?t:(0,i.Z)(+t),d):n},d.y1=function(t){return arguments.length?(l=null==t?null:"function"==typeof t?t:(0,i.Z)(+t),d):l},d.lineX0=d.lineY0=function(){return p().x(t).y(n)},d.lineY1=function(){return p().x(t).y(l)},d.lineX1=function(){return p().x(e).y(n)},d.defined=function(t){return arguments.length?(u="function"==typeof t?t:(0,i.Z)(!!t),d):u},d.curve=function(t){return arguments.length?(h=t,null!=c&&(f=h(c)),d):h},d.context=function(t){return arguments.length?(null==t?c=f=null:f=h(c=t),d):c},d}},56297:function(t,e,n){"use strict";function r(t){return function(){return t}}n.d(e,{Z:function(){return r}})},41545:function(t,e,n){"use strict";function r(t){this._context=t}function i(t){return new r(t)}n.d(e,{Z:function(){return i}}),r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}}},60508:function(t,e,n){"use strict";n.d(e,{Nb:function(){return A},SO:function(){return E.Z},am:function(){return B},$0:function(){return gt},Dt:function(){return xt},WQ:function(){return bt},tF:function(){return kt},YY:function(){return Tt},Ov:function(){return St},dC:function(){return Ot},zg:function(){return It},fG:function(){return Lt},$m:function(){return Ft},c_:function(){return O.Z},fx:function(){return qt},Fd:function(){return Xt},ak:function(){return Kt},Sx:function(){return $t},eA:function(){return te},js:function(){return ne},iJ:function(){return ee},jv:function(){return T.Z},XB:function(){return L},h5:function(){return V},M4:function(){return K},rR:function(){return X},ve:function(){return N},Hs:function(){return F},N1:function(){return B},aJ:function(){return L},kn:function(){return oe},W$:function(){return le},pB:function(){return se},HL:function(){return re},Ku:function(){return ue},YG:function(){return ce},mG:function(){return he},$K:function(){return de},IX:function(){return _e},FP:function(){return me},Qx:function(){return ie},cY:function(){return ye},NA:function(){return pt},JF:function(){return W},tJ:function(){return J},rZ:function(){return tt},m_:function(){return at},Hm:function(){return it},P6:function(){return st},n3:function(){return ft},uH:function(){return dt}});var r=n(52508),i=n(56297),a=Math.abs,o=Math.atan2,s=Math.cos,l=Math.max,u=Math.min,c=Math.sin,h=Math.sqrt,f=1e-12,d=Math.PI,p=d/2,_=2*d;function m(t){return t>1?0:t<-1?d:Math.acos(t)}function y(t){return t>=1?p:t<=-1?-p:Math.asin(t)}function g(t){return t.innerRadius}function v(t){return t.outerRadius}function x(t){return t.startAngle}function w(t){return t.endAngle}function b(t){return t&&t.padAngle}function z(t,e,n,r,i,a,o,s){var l=n-t,u=r-e,c=o-i,h=s-a,d=h*l-c*u;if(!(d*d<f))return[t+(d=(c*(e-a)-h*(t-i))/d)*l,e+d*u]}function k(t,e,n,r,i,a,o){var s=t-n,u=e-r,c=(o?a:-a)/h(s*s+u*u),f=c*u,d=-c*s,p=t+f,_=e+d,m=n+f,y=r+d,g=(p+m)/2,v=(_+y)/2,x=m-p,w=y-_,b=x*x+w*w,z=i-a,k=p*y-m*_,A=(w<0?-1:1)*h(l(0,z*z*b-k*k)),E=(k*w-x*A)/b,T=(-k*x-w*A)/b,M=(k*w+x*A)/b,S=(-k*x+w*A)/b,N=E-g,O=T-v,Z=M-g,C=S-v;return N*N+O*O>Z*Z+C*C&&(E=M,T=S),{cx:E,cy:T,x01:-f,y01:-d,x11:E*(i/z-1),y11:T*(i/z-1)}}function A(){var t=g,e=v,n=(0,i.Z)(0),l=null,A=x,E=w,T=b,M=null;function S(){var i,g,v=+t.apply(this,arguments),x=+e.apply(this,arguments),w=A.apply(this,arguments)-p,b=E.apply(this,arguments)-p,S=a(b-w),N=b>w;if(M||(M=i=(0,r.Z)()),x<v&&(g=x,x=v,v=g),x>f)if(S>_-f)M.moveTo(x*s(w),x*c(w)),M.arc(0,0,x,w,b,!N),v>f&&(M.moveTo(v*s(b),v*c(b)),M.arc(0,0,v,b,w,N));else{var O,Z,C=w,I=b,D=w,L=b,B=S,F=S,P=T.apply(this,arguments)/2,q=P>f&&(l?+l.apply(this,arguments):h(v*v+x*x)),U=u(a(x-v)/2,+n.apply(this,arguments)),Y=U,R=U;if(q>f){var j=y(q/v*c(P)),H=y(q/x*c(P));(B-=2*j)>f?(D+=j*=N?1:-1,L-=j):(B=0,D=L=(w+b)/2),(F-=2*H)>f?(C+=H*=N?1:-1,I-=H):(F=0,C=I=(w+b)/2)}var G=x*s(C),V=x*c(C),X=v*s(L),K=v*c(L);if(U>f){var W,J=x*s(I),$=x*c(I),Q=v*s(D),tt=v*c(D);if(S<d&&(W=z(G,V,Q,tt,J,$,X,K))){var et=G-W[0],nt=V-W[1],rt=J-W[0],it=$-W[1],at=1/c(m((et*rt+nt*it)/(h(et*et+nt*nt)*h(rt*rt+it*it)))/2),ot=h(W[0]*W[0]+W[1]*W[1]);Y=u(U,(v-ot)/(at-1)),R=u(U,(x-ot)/(at+1))}}F>f?R>f?(O=k(Q,tt,G,V,x,R,N),Z=k(J,$,X,K,x,R,N),M.moveTo(O.cx+O.x01,O.cy+O.y01),R<U?M.arc(O.cx,O.cy,R,o(O.y01,O.x01),o(Z.y01,Z.x01),!N):(M.arc(O.cx,O.cy,R,o(O.y01,O.x01),o(O.y11,O.x11),!N),M.arc(0,0,x,o(O.cy+O.y11,O.cx+O.x11),o(Z.cy+Z.y11,Z.cx+Z.x11),!N),M.arc(Z.cx,Z.cy,R,o(Z.y11,Z.x11),o(Z.y01,Z.x01),!N))):(M.moveTo(G,V),M.arc(0,0,x,C,I,!N)):M.moveTo(G,V),v>f&&B>f?Y>f?(O=k(X,K,J,$,v,-Y,N),Z=k(G,V,Q,tt,v,-Y,N),M.lineTo(O.cx+O.x01,O.cy+O.y01),Y<U?M.arc(O.cx,O.cy,Y,o(O.y01,O.x01),o(Z.y01,Z.x01),!N):(M.arc(O.cx,O.cy,Y,o(O.y01,O.x01),o(O.y11,O.x11),!N),M.arc(0,0,v,o(O.cy+O.y11,O.cx+O.x11),o(Z.cy+Z.y11,Z.cx+Z.x11),N),M.arc(Z.cx,Z.cy,Y,o(Z.y11,Z.x11),o(Z.y01,Z.x01),!N))):M.arc(0,0,v,L,D,N):M.lineTo(X,K)}else M.moveTo(0,0);if(M.closePath(),i)return M=null,i+""||null}return S.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+A.apply(this,arguments)+ +E.apply(this,arguments))/2-d/2;return[s(r)*n,c(r)*n]},S.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.Z)(+e),S):t},S.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:(0,i.Z)(+t),S):e},S.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:(0,i.Z)(+t),S):n},S.padRadius=function(t){return arguments.length?(l=null==t?null:"function"==typeof t?t:(0,i.Z)(+t),S):l},S.startAngle=function(t){return arguments.length?(A="function"==typeof t?t:(0,i.Z)(+t),S):A},S.endAngle=function(t){return arguments.length?(E="function"==typeof t?t:(0,i.Z)(+t),S):E},S.padAngle=function(t){return arguments.length?(T="function"==typeof t?t:(0,i.Z)(+t),S):T},S.context=function(t){return arguments.length?(M=null==t?null:t,S):M},S}var E=n(45902),T=n(23780);function M(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function S(t){return t}function N(){var t=S,e=M,n=null,r=(0,i.Z)(0),a=(0,i.Z)(_),o=(0,i.Z)(0);function s(i){var s,l,u,c,h,f=i.length,d=0,p=new Array(f),m=new Array(f),y=+r.apply(this,arguments),g=Math.min(_,Math.max(-_,a.apply(this,arguments)-y)),v=Math.min(Math.abs(g)/f,o.apply(this,arguments)),x=v*(g<0?-1:1);for(s=0;s<f;++s)(h=m[p[s]=s]=+t(i[s],s,i))>0&&(d+=h);for(null!=e?p.sort((function(t,n){return e(m[t],m[n])})):null!=n&&p.sort((function(t,e){return n(i[t],i[e])})),s=0,u=d?(g-f*x)/d:0;s<f;++s,y=c)l=p[s],c=y+((h=m[l])>0?h*u:0)+x,m[l]={data:i[l],index:s,value:h,startAngle:y,endAngle:c,padAngle:v};return m}return s.value=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.Z)(+e),s):t},s.sortValues=function(t){return arguments.length?(e=t,n=null,s):e},s.sort=function(t){return arguments.length?(n=t,e=null,s):n},s.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:(0,i.Z)(+t),s):r},s.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:(0,i.Z)(+t),s):a},s.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:(0,i.Z)(+t),s):o},s}var O=n(41545),Z=I(O.Z);function C(t){this._curve=t}function I(t){function e(e){return new C(t(e))}return e._curve=t,e}function D(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(I(t)):e()._curve},t}function L(){return D((0,T.Z)().curve(Z))}function B(){var t=(0,E.Z)().curve(Z),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,a=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return D(n())},delete t.lineX0,t.lineEndAngle=function(){return D(r())},delete t.lineX1,t.lineInnerRadius=function(){return D(i())},delete t.lineY0,t.lineOuterRadius=function(){return D(a())},delete t.lineY1,t.curve=function(t){return arguments.length?e(I(t)):e()._curve},t}function F(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}C.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var P=Array.prototype.slice,q=n(32337);function U(t){return t.source}function Y(t){return t.target}function R(t){var e=U,n=Y,a=q.x,o=q.y,s=null;function l(){var i,l=P.call(arguments),u=e.apply(this,l),c=n.apply(this,l);if(s||(s=i=(0,r.Z)()),t(s,+a.apply(this,(l[0]=u,l)),+o.apply(this,l),+a.apply(this,(l[0]=c,l)),+o.apply(this,l)),i)return s=null,i+""||null}return l.source=function(t){return arguments.length?(e=t,l):e},l.target=function(t){return arguments.length?(n=t,l):n},l.x=function(t){return arguments.length?(a="function"==typeof t?t:(0,i.Z)(+t),l):a},l.y=function(t){return arguments.length?(o="function"==typeof t?t:(0,i.Z)(+t),l):o},l.context=function(t){return arguments.length?(s=null==t?null:t,l):s},l}function j(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,i,r,i)}function H(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+i)/2,r,n,r,i)}function G(t,e,n,r,i){var a=F(e,n),o=F(e,n=(n+i)/2),s=F(r,n),l=F(r,i);t.moveTo(a[0],a[1]),t.bezierCurveTo(o[0],o[1],s[0],s[1],l[0],l[1])}function V(){return R(j)}function X(){return R(H)}function K(){var t=R(G);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}var W={draw:function(t,e){var n=Math.sqrt(e/d);t.moveTo(n,0),t.arc(0,0,n,0,_)}},J={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},$=Math.sqrt(1/3),Q=2*$,tt={draw:function(t,e){var n=Math.sqrt(e/Q),r=n*$;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},et=Math.sin(d/10)/Math.sin(7*d/10),nt=Math.sin(_/10)*et,rt=-Math.cos(_/10)*et,it={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=nt*n,i=rt*n;t.moveTo(0,-n),t.lineTo(r,i);for(var a=1;a<5;++a){var o=_*a/5,s=Math.cos(o),l=Math.sin(o);t.lineTo(l*n,-s*n),t.lineTo(s*r-l*i,l*r+s*i)}t.closePath()}},at={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},ot=Math.sqrt(3),st={draw:function(t,e){var n=-Math.sqrt(e/(3*ot));t.moveTo(0,2*n),t.lineTo(-ot*n,-n),t.lineTo(ot*n,-n),t.closePath()}},lt=-.5,ut=Math.sqrt(3)/2,ct=1/Math.sqrt(12),ht=3*(ct/2+1),ft={draw:function(t,e){var n=Math.sqrt(e/ht),r=n/2,i=n*ct,a=r,o=n*ct+n,s=-a,l=o;t.moveTo(r,i),t.lineTo(a,o),t.lineTo(s,l),t.lineTo(lt*r-ut*i,ut*r+lt*i),t.lineTo(lt*a-ut*o,ut*a+lt*o),t.lineTo(lt*s-ut*l,ut*s+lt*l),t.lineTo(lt*r+ut*i,lt*i-ut*r),t.lineTo(lt*a+ut*o,lt*o-ut*a),t.lineTo(lt*s+ut*l,lt*l-ut*s),t.closePath()}},dt=[W,J,tt,at,it,st,ft];function pt(){var t=(0,i.Z)(W),e=(0,i.Z)(64),n=null;function a(){var i;if(n||(n=i=(0,r.Z)()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return a.type=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.Z)(e),a):t},a.size=function(t){return arguments.length?(e="function"==typeof t?t:(0,i.Z)(+t),a):e},a.context=function(t){return arguments.length?(n=null==t?null:t,a):n},a}function _t(){}function mt(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function yt(t){this._context=t}function gt(t){return new yt(t)}function vt(t){this._context=t}function xt(t){return new vt(t)}function wt(t){this._context=t}function bt(t){return new wt(t)}function zt(t,e){this._basis=new yt(t),this._beta=e}yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:mt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:mt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},vt.prototype={areaStart:_t,areaEnd:_t,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:mt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:mt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},zt.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,s=e[n]-a,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(i+r*o),this._beta*e[l]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var kt=function t(e){function n(t){return 1===e?new yt(t):new zt(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function At(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Et(t,e){this._context=t,this._k=(1-e)/6}Et.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:At(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:At(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Tt=function t(e){function n(t){return new Et(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Mt(t,e){this._context=t,this._k=(1-e)/6}Mt.prototype={areaStart:_t,areaEnd:_t,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:At(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var St=function t(e){function n(t){return new Mt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Nt(t,e){this._context=t,this._k=(1-e)/6}Nt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:At(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ot=function t(e){function n(t){return new Nt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Zt(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>f){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>f){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*u+t._x1*t._l23_2a-e*t._l12_2a)/c,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function Ct(t,e){this._context=t,this._alpha=e}Ct.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Zt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var It=function t(e){function n(t){return e?new Ct(t,e):new Et(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Dt(t,e){this._context=t,this._alpha=e}Dt.prototype={areaStart:_t,areaEnd:_t,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Zt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Lt=function t(e){function n(t){return e?new Dt(t,e):new Mt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Bt(t,e){this._context=t,this._alpha=e}Bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Zt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ft=function t(e){function n(t){return e?new Bt(t,e):new Nt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Pt(t){this._context=t}function qt(t){return new Pt(t)}function Ut(t){return t<0?-1:1}function Yt(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(Ut(a)+Ut(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Rt(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function jt(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function Ht(t){this._context=t}function Gt(t){this._context=new Vt(t)}function Vt(t){this._context=t}function Xt(t){return new Ht(t)}function Kt(t){return new Gt(t)}function Wt(t){this._context=t}function Jt(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function $t(t){return new Wt(t)}function Qt(t,e){this._context=t,this._t=e}function te(t){return new Qt(t,.5)}function ee(t){return new Qt(t,0)}function ne(t){return new Qt(t,1)}function re(t,e){if((i=t.length)>1)for(var n,r,i,a=1,o=t[e[0]],s=o.length;a<i;++a)for(r=o,o=t[e[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function ie(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function ae(t,e){return t[e]}function oe(){var t=(0,i.Z)([]),e=ie,n=re,r=ae;function a(i){var a,o,s=t.apply(this,arguments),l=i.length,u=s.length,c=new Array(u);for(a=0;a<u;++a){for(var h,f=s[a],d=c[a]=new Array(l),p=0;p<l;++p)d[p]=h=[0,+r(i[p],f,p,i)],h.data=i[p];d.key=f}for(a=0,o=e(c);a<u;++a)c[o[a]].index=a;return n(c,o),c}return a.keys=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.Z)(P.call(e)),a):t},a.value=function(t){return arguments.length?(r="function"==typeof t?t:(0,i.Z)(+t),a):r},a.order=function(t){return arguments.length?(e=null==t?ie:"function"==typeof t?t:(0,i.Z)(P.call(t)),a):e},a.offset=function(t){return arguments.length?(n=null==t?re:t,a):n},a}function se(t,e){if((r=t.length)>0){for(var n,r,i,a=0,o=t[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=t[n][a][1]||0;if(i)for(n=0;n<r;++n)t[n][a][1]/=i}re(t,e)}}function le(t,e){if((s=t.length)>0)for(var n,r,i,a,o,s,l=0,u=t[e[0]].length;l<u;++l)for(a=o=0,n=0;n<s;++n)(i=(r=t[e[n]][l])[1]-r[0])>0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):(r[0]=0,r[1]=i)}function ue(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],a=i.length;r<a;++r){for(var o=0,s=0;o<n;++o)s+=t[o][r][1]||0;i[r][1]+=i[r][0]=-s/2}re(t,e)}}function ce(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var s=0,l=0,u=0;s<i;++s){for(var c=t[e[s]],h=c[o][1]||0,f=(h-(c[o-1][1]||0))/2,d=0;d<s;++d){var p=t[e[d]];f+=(p[o][1]||0)-(p[o-1][1]||0)}l+=h,u+=f*h}n[o-1][1]+=n[o-1][0]=a,l&&(a-=u/l)}n[o-1][1]+=n[o-1][0]=a,re(t,e)}}function he(t){var e=t.map(fe);return ie(t).sort((function(t,n){return e[t]-e[n]}))}function fe(t){for(var e,n=-1,r=0,i=t.length,a=-1/0;++n<i;)(e=+t[n][1])>a&&(a=e,r=n);return r}function de(t){var e=t.map(pe);return ie(t).sort((function(t,n){return e[t]-e[n]}))}function pe(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}function _e(t){return de(t).reverse()}function me(t){var e,n,r=t.length,i=t.map(pe),a=he(t),o=0,s=0,l=[],u=[];for(e=0;e<r;++e)n=a[e],o<s?(o+=i[n],l.push(n)):(s+=i[n],u.push(n));return u.reverse().concat(l)}function ye(t){return ie(t).reverse()}Pt.prototype={areaStart:_t,areaEnd:_t,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Ht.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:jt(this,this._t0,Rt(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,jt(this,Rt(this,n=Yt(this,t,e)),n);break;default:jt(this,this._t0,n=Yt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Gt.prototype=Object.create(Ht.prototype)).point=function(t,e){Ht.prototype.point.call(this,e,t)},Vt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},Wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=Jt(t),i=Jt(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Qt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}}},23780:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var r=n(52508),i=n(56297),a=n(41545),o=n(32337);function s(){var t=o.x,e=o.y,n=(0,i.Z)(!0),s=null,l=a.Z,u=null;function c(i){var a,o,c,h=i.length,f=!1;for(null==s&&(u=l(c=(0,r.Z)())),a=0;a<=h;++a)!(a<h&&n(o=i[a],a,i))===f&&((f=!f)?u.lineStart():u.lineEnd()),f&&u.point(+t(o,a,i),+e(o,a,i));if(c)return u=null,c+""||null}return c.x=function(e){return arguments.length?(t="function"==typeof e?e:(0,i.Z)(+e),c):t},c.y=function(t){return arguments.length?(e="function"==typeof t?t:(0,i.Z)(+t),c):e},c.defined=function(t){return arguments.length?(n="function"==typeof t?t:(0,i.Z)(!!t),c):n},c.curve=function(t){return arguments.length?(l=t,null!=s&&(u=l(s)),c):l},c.context=function(t){return arguments.length?(null==t?s=u=null:u=l(s=t),c):s},c}},32337:function(t,e,n){"use strict";function r(t){return t[0]}function i(t){return t[1]}n.d(e,{x:function(){return r},y:function(){return i}})},10527:function(t,e,n){"use strict";n.d(e,{IH:function(){return f},PI:function(){return p}});var r=n(91843),i=n(56327),a=n(85516),o=n(6939);let s={breast_cancer:"breast_cancer_diagnosis_age",breast_cancer2:"breast_cancer2_diagnosis_age",ovarian_cancer:"ovarian_cancer_diagnosis_age",prostate_cancer:"prostate_cancer_diagnosis_age",pancreatic_cancer:"pancreatic_cancer_diagnosis_age"},l=["brca1","brca2","palb2","atm","chek2","rad51d","rad51c","brip1"],u=["er","pr","her2","ck14","ck56"];new Object;var c=n(6939),h=n(44449);function f(t){c("#load").change((function(e){!function(t,e){let n=t.target.files[0];if(n){let t,h=new FileReader;h.onload=function(n){e.DEBUG&&console.log(n.target.result);try{if(0===n.target.result.indexOf("BOADICEA import pedigree file format 4.0"))e.dataset=y(n.target.result,4),m(e);else if(0===n.target.result.indexOf("BOADICEA import pedigree file format 2.0"))e.dataset=y(n.target.result,2),m(e);else if(0===n.target.result.indexOf("##")&&-1!==n.target.result.indexOf("CanRisk")){let r=function(t){let[e,n]=function(t){let e=t.trim().split("\n"),n=[],r=[];for(let t=0;t<e.length;t++){let i=e[t].trim();if(0===i.indexOf("##")){if(0===i.indexOf("##CanRisk")&&i.indexOf(";")>-1){let t=i.split(";");for(let e=1;e<t.length;e++)2===t[e].split("=").length&&r.push(t[e])}-1===i.indexOf("CanRisk")&&0!==i.indexOf("##FamID")&&r.push(i.replace("##",""));continue}let a=/\t/;i.indexOf("\t")<0&&(a=/\s+/,console.log("NOT TAB DELIM"));let c=o.map(i.split(a),(function(t,e){return t.trim()}));if(c.length>1){let e={famid:c[0],display_name:c[1],name:c[3],sex:c[6],status:c[8]};1==c[2]&&(e.proband=!0),"0"!==c[4]&&(e.father=c[4]),"0"!==c[5]&&(e.mother=c[5]),"0"!==c[7]&&(e.mztwin=c[7]),"0"!==c[9]&&(e.age=c[9]),"0"!==c[10]&&(e.yob=c[10]);let r=11;o.each(s,(function(t,n){"0"!==c[r]&&(e[n]=c[r]),r++})),"0"!==c[r++]&&(e.ashkenazi=1);for(let n=0;n<l.length;n++){let i=c[r].split(":");"0"!==i[0]&&("S"!==i[0]&&"T"!==i[0]||"P"!==i[1]&&"N"!==i[1]?console.warn("UNRECOGNISED GENE TEST ON LINE "+(t+1)+": "+i[0]+" "+i[1]):e[l[n]+"_gene_test"]={type:i[0],result:i[1]}),r++}let i=c[r].split(":");for(let n=0;n<i.length;n++)"0"!==i[n]&&("N"===i[n]||"P"===i[n]?e[u[n]+"_bc_pathology"]=i[n]:console.warn("UNRECOGNISED PATHOLOGY ON LINE "+(t+1)+": "+u[n]+" "+i[n]));n.unshift(e)}}return[r,n]}(t);try{return[e,g(n)]}catch(t){return console.error(t),[e,n]}}(n.target.result);t=r[0],e.dataset=r[1],m(e)}else try{e.dataset=JSON.parse(n.target.result)}catch(t){e.dataset=function(t){let e,n=t.trim().split("\n"),r=[];for(let t=0;t<n.length;t++){let i=c.map(n[t].trim().split(/\s+/),(function(t,e){return t.trim()}));if(i.length<5)throw"unknown format";let a="1"==i[4]?"M":"2"==i[4]?"F":"U",o={famid:i[0],display_name:i[1],name:i[1],sex:a};if("0"!==i[2]&&(o.father=i[2]),"0"!==i[3]&&(o.mother=i[3]),void 0!==e&&e!==o.famid){console.error("multiple family IDs found only using famid = "+e);break}if("2"==i[5]&&(o.affected=2),i.length>6){o.alleles="";for(let t=6;t<i.length;t+=2)o.alleles+=i[t]+"/"+i[t+1]+";"}r.unshift(o),e=i[0]}return g(r)}(n.target.result)}(0,a.ZR)(e)}catch(t){return console.error(t,n.target.result),void r.sY("File Error",t.message?t.message:t)}console.log(e.dataset);try{i.N0(e),(0,a.VU)(e),console.log(t),c(document).trigger("riskfactorChange",[e,t]),c(document).trigger("fhChange",[e]);try{acc_FamHist_ticked(),acc_FamHist_Leave(),RESULT.FLAG_FAMILY_MODAL=!0}catch(t){}}catch(t){r.sY("File Error",t.message?t.message:t)}},h.onerror=function(t){r.sY("File Error","File could not be read! Code "+t.target.error.code)},h.readAsText(n)}else console.error("File could not be read!");c("#load")[0].value=""}(e,t)})),c("#save").click((function(e){!function(t){let e=JSON.stringify(i.Vk(t));!function(t,e,n,r){t.DEBUG&&console.log(e);n||(n="ped.txt");r||(r="text/plain");let i=new Blob([e],{type:r});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,n);else{let t=document.createElement("a"),e=URL.createObjectURL(i);t.href=e,t.download=n,document.body.appendChild(t),t.click(),setTimeout((function(){document.body.removeChild(t),window.URL.revokeObjectURL(e)}),0)}}(t,e)}(t)})),c("#print").click((function(e){!function(t,e){t.constructor!==Array&&(t=[t]);let n=.9*c(window).width(),r=c(window).height()-10,i=["/static/css/canrisk.css","https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"],a=window.open("","PrintMap","width="+n+",height="+r),o="";for(let t=0;t<i.length;t++)o+='<link href="'+i[t]+'" rel="stylesheet" type="text/css" media="all">';o+="<style>body {font-size: "+c("body").css("font-size")+";}</style>";let s="";for(let n=0;n<t.length;n++)0===n&&e&&(s+=e),s+=c(t[n]).html(),n<t.length-1&&(s+='<div class="page-break"> </div>');a.document.write(o),a.document.write(s),a.document.close(),a.focus(),setTimeout((function(){a.print(),a.close()}),300)}(_(t))})),c("#svg_download").click((function(e){!function(t){let e=document.createElement("a");e.href="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.html()))),e.download="plot.svg",e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)}(_(t))})),c("#png_download").click((function(t){let e=p(c("svg"),"pedigree");c.when.apply(c,[e]).done((function(){let t=d(arguments,"pedigree");if(r.un()||r.w1()){let e="<img src='"+t.img+"' alt='canvas image'/>";window.open().document.write(e)}else{let e=document.createElement("a");e.href=t.img,e.download="plot.png",e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)}}))}))}function d(t,e){return c.grep(t,(function(t){return t&&t.name==e}))[0]}function p(t,e,n){let i={iscanvg:!1,resolution:1,img_type:"image/png"};if(n||(n=i),c.each(i,(function(t,e){t in n||(n[t]=e)})),0===t.find(".pdf-white-bg").length){let e=h.select(t.get(0));e.append("rect").attr("width","100%").attr("height","100%").attr("class","pdf-white-bg").attr("fill","white"),e.select(".pdf-white-bg").lower()}let a,o=c.Deferred();void 0!==window.XMLSerializer?a=(new XMLSerializer).serializeToString(t.get(0)):void 0!==t.xml&&(a=t.get(0).xml);let s="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(a))),l=document.createElement("canvas");l.width=t.width()*n.resolution,l.height=t.height()*n.resolution;let u=l.getContext("2d"),f=document.createElement("img");return f.onload=function(){if(r.w1()){a=a.replace(/ font-size="\d?.\d*em"/g,""),a=a.replace(/<text /g,'<text font-size="12px" '),canvg.Canvg.fromString(u,a,{scaleWidth:l.width,scaleHeight:l.height,ignoreDimensions:!0}).start(),console.log(e,n.img_type,"use canvg to create image")}else u.drawImage(f,0,0,l.width,l.height),console.log(e,n.img_type);o.resolve({name:e,resolution:n.resolution,img:l.toDataURL(n.img_type,1),w:l.width,h:l.height})},f.src=s,o.promise()}function _(t){let e=i.Vk(t);null!=e&&(t.dataset=e);let n=(0,a.t_)(t),r=c("<div></div>"),o=c("#"+t.targetDiv).find("svg").clone().appendTo(r),s=515,l=757;if(t.width<n.width||t.height<n.height||n.width>s||n.height>l){let e=n.width,r=n.height+100,i=1;if(n.width>s||n.height>l){n.width>s&&(e=s),n.height>l&&(r=l);let t=e/n.width,a=r/n.height;i=t<a?t:a}o.attr("width",e),o.attr("height",r);let a=1.5*-t.symbol_size*i;o.find(".diagram").attr("transform","translate(0, "+a+") scale("+i+")")}return r}function m(t){c.each(t.dataset,(function(t,e){if(!e.hidden&&"M"===e.sex&&!r.IL(e)&&e[s.breast_cancer2]){let t="Male family member ("+e.display_name+") with contralateral breast cancer found. Please note that as the risk models do not take this into account the second breast cancer is ignored.";console.error(t),delete e[s.breast_cancer2],r.sY("Warning",t)}}))}function y(t,e){let n=t.trim().split("\n"),r=[];for(let t=2;t<n.length;t++){let i=c.map(n[t].trim().split(/\s+/),(function(t,e){return t.trim()}));if(i.length>1){let n={famid:i[0],display_name:i[1],name:i[3],sex:i[6],status:i[8]};1==i[2]&&(n.proband=!0),"0"!==i[4]&&(n.father=i[4]),"0"!==i[5]&&(n.mother=i[5]),"0"!==i[7]&&(n.mztwin=i[7]),"0"!==i[9]&&(n.age=i[9]),"0"!==i[10]&&(n.yob=i[10]);let a=11;if(c.each(s,(function(t,e){"0"!==i[a]&&(n[e]=i[a]),a++})),4===e){"0"!==i[a++]&&(n.ashkenazi=1);for(let e=0;e<5;e++)a+=2,"0"!==i[a-2]&&("S"!==i[a-2]&&"T"!==i[a-2]||"P"!==i[a-1]&&"N"!==i[a-1]?console.warn("UNRECOGNISED GENE TEST ON LINE "+(t+1)+": "+i[a-2]+" "+i[a-1]):n[l[e]+"_gene_test"]={type:i[a-2],result:i[a-1]})}else 2===e&&(a+=2,"0"!==i[a-2]&&("S"===i[a-2]||"T"===i[a-2]?"N"===i[a-1]?(n.brca1_gene_test={type:i[a-2],result:"N"},n.brca2_gene_test={type:i[a-2],result:"N"}):"1"===i[a-1]?(n.brca1_gene_test={type:i[a-2],result:"P"},n.brca2_gene_test={type:i[a-2],result:"N"}):"2"===i[a-1]?(n.brca1_gene_test={type:i[a-2],result:"N"},n.brca2_gene_test={type:i[a-2],result:"P"}):"3"===i[a-1]&&(n.brca1_gene_test={type:i[a-2],result:"P"},n.brca2_gene_test={type:i[a-2],result:"P"}):console.warn("UNRECOGNISED GENE TEST ON LINE "+(t+1)+": "+i[a-2]+" "+i[a-1])),"0"!==i[a++]&&(n.ashkenazi=1));for(let e=0;e<u.length;e++)"0"!==i[a]&&("N"===i[a]||"P"===i[a]?n[u[e]+"_bc_pathology"]=i[a]:console.warn("UNRECOGNISED PATHOLOGY ON LINE "+(t+1)+": "+u[e]+" "+i[a])),a++;r.unshift(n)}}try{return g(r)}catch(t){return console.error(t),r}}function g(t){for(let e=0;e<2;e++)for(let e=0;e<t.length;e++)x(t,t[e].name);let e=0;for(let n=0;n<t.length;n++)t[n].level&&t[n].level>e&&(e=t[n].level);for(let n=0;n<t.length;n++)if(1==r.hh(t,t[n].name))if(t[n].level&&t[n].level==e)t[n].top_level=!0;else{t[n].noparents=!0;let e=v(t,t[n]);if(e>-1&&t[e].mother&&(t[n].mother=t[e].mother,t[n].father=t[e].father),!t[n].mother)for(let r=0;r<t.length;r++)t[n].level==t[r].level-1&&(e=v(t,t[r]),e>-1&&(t[n].mother="F"===t[r].sex?t[r].name:t[e].name,t[n].father="M"===t[r].sex?t[r].name:t[e].name))}else delete t[n].top_level;return t}function v(t,e){for(let n=0;n<t.length;n++){let i=t[n];if(e.name===i.mother)return r.qj(t,i.father);if(e.name===i.father)return r.qj(t,i.mother)}return-1}function x(t,e){let n=r.qj(t,e);w(n,t[n].level?t[n].level:0,t)}function w(t,e,n){let i=["mother","father"];e++;for(let a=0;a<i.length;a++){let o=r.qj(n,n[t][i[a]]);if(o>=0){let i=n[r.qj(n,n[t].mother)],a=n[r.qj(n,n[t].father)];(!n[o].level||n[o].level<e)&&(i.level=e,a.level=e),i.level<a.level?i.level=a.level:a.level<i.level&&(a.level=i.level),w(o,e,n)}}}},56327:function(t,e,n){"use strict";n.d(e,{Fx:function(){return c},bn:function(){return h},k8:function(){return d},m6:function(){return p},Vk:function(){return _},Xp:function(){return m},lp:function(){return y},ZH:function(){return g},N0:function(){return v},cF:function(){return x}});let r=25,i={};function a(t){try{if("array"===t.store_type)return!1;if("local"!==t.store_type&&"session"!==t.store_type&&void 0!==t.store_type)return!1;let e="test";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}function o(t){return"PEDIGREE_"+t.btn_target+"_"}function s(t){return i[o(t)]}function l(t,e){return"local"===t.store_type?localStorage.getItem(e):sessionStorage.getItem(e)}function u(t,e,n){return"local"===t.store_type?localStorage.setItem(e,n):sessionStorage.setItem(e,n)}function c(t){let e=o(t),n="local"===t.store_type?localStorage:sessionStorage,r=[];for(let t=0;t<n.length;t++)0==n.key(t).indexOf(e)&&r.push(n.key(t));for(let t=0;t<r.length;t++)n.removeItem(r[t])}function h(t){let e;return e=a(t)?l(t,o(t)+"COUNT"):i[o(t)+"COUNT"],null!=e?e:0}function f(t,e){a(t)?u(t,o(t)+"COUNT",e):i[o(t)+"COUNT"]=e}function d(t){if(!t.dataset)return;let e=h(t);a(t)?u(t,o(t)+e,JSON.stringify(t.dataset)):(console.warn("Local storage not found/supported for this browser!",t.store_type),r=500,void 0===s(t)&&(i[o(t)]=[]),s(t).push(JSON.stringify(t.dataset))),e<r?e++:e=0,f(t,e)}function p(t){if(!a(t))return s(t)&&s(t).length>0?s(t).length:-1;for(let e=r;e>0;e--)if(null!==l(t,o(t)+(e-1)))return e;return-1}function _(t){let e=h(t)-1;return-1==e&&(e=r),a(t)?JSON.parse(l(t,o(t)+e)):s(t)?JSON.parse(s(t)[e]):void 0}function m(t,e){if(void 0===e&&(e=h(t)-2),e<0){let n=n(t);e=n<r?n-1:r-1}return f(t,e+1),a(t)?JSON.parse(l(t,o(t)+e)):JSON.parse(s(t)[e])}function y(t,e){return void 0===e&&(e=h(t)),e>=r&&(e=0),f(t,parseInt(e)+1),a(t)?JSON.parse(l(t,o(t)+e)):JSON.parse(s(t)[e])}function g(t){a(t)&&function(t){"local"===t.store_type?localStorage.clear():sessionStorage.clear()}(t),i={}}function v(t,e,n,r){if(a(t)){let i="local"===t.store_type?localStorage:sessionStorage;e?(u(t,o(t)+"_X",e),u(t,o(t)+"_Y",n)):(i.removeItem(o(t)+"_X"),i.removeItem(o(t)+"_Y"));let a=o(t)+"_ZOOM";r?u(t,a,r):i.removeItem(a)}}function x(t){if(!a(t)||null===localStorage.getItem(o(t)+"_X")&&null===sessionStorage.getItem(o(t)+"_X"))return[null,null];let e=[parseInt(l(t,o(t)+"_X")),parseInt(l(t,o(t)+"_Y"))];return null!==l(t,o(t)+"_ZOOM")&&e.push(parseFloat(l(t,o(t)+"_ZOOM"))),e}},85516:function(t,e,n){"use strict";n.d(e,{Bm:function(){return j},c:function(){return X},nZ:function(){return K},cd:function(){return H},J_:function(){return L},j:function(){return J},t_:function(){return Y},VU:function(){return R},hN:function(){return V},ZR:function(){return F}});var r=n(91843),i=n(56327),a=n(44449);let o;function s(t,e){let n=t.symbol_size/2,r=2.5*-t.symbol_size;o=a.zoom().scaleExtent([t.zoomIn,t.zoomOut]).filter((function(){return!((!t.zoomSrc||-1===t.zoomSrc.indexOf("wheel"))&&a.event.type&&"wheel"===a.event.type)&&("dblclick"!==a.event.type&&!a.event.button)})).on("zoom",(function(){!function(t){t.DEBUG&&console.log("zoom",a.event,a.event.transform);let e=a.event.transform,n=e.k&&1!==e.k?e.k:void 0;(0,i.N0)(t,e.x,e.y,n),a.select("#"+t.targetDiv).select(".diagram").attr("transform","translate("+e.x+","+e.y+")"+(n?" scale("+n+")":""))}(t)})),e.call(o);let s=(0,i.cF)(t),l=3==s.length?s[2]:1,u=null!==s[0]?s[0]/l:n*l,c=null!==s[1]?s[1]/l:r*l;var h=a.zoomIdentity.scale(l).translate(u,c);e.call(o.transform,h)}function l(t,e){a.select("#"+t.targetDiv).select("svg").transition().duration(50).call(o.scaleBy,e)}function u(t){let e=function(t){let e=c(t);return{wid:Math.abs(e.xmax-e.xmin),hgt:Math.abs(e.ymax-e.ymin)}}(t),n=a.select("#"+t.targetDiv).select("svg"),r=function(t){return{w:t.node().clientWidth,h:t.node().clientHeight}}(n),i=(r.w-2*t.symbol_size)/r.w/Math.max(e.wid/r.w,e.hgt/r.h);i<t.zoomIn&&o.scaleExtent([i,t.zoomOut]);let s=function(t){let e=c(t);return{x:e.xmin+(e.xmax-e.xmin)/2,y:e.ymin+(e.ymax-e.ymin)/2}}(t);n.call(o.translateTo,s.x,s.y),setTimeout((function(){n.transition().duration(700).call(o.scaleTo,i)}),400)}function c(t){let e=a.select("#"+t.targetDiv).select(".diagram"),n=Number.MAX_VALUE,r=-1e6,i=Number.MAX_VALUE,o=-1e6,s=t.symbol_size/2;return e.selectAll("g").each((function(t,e){t.x&&"hidden_root"!==t.data.name&&(t.x-s<n&&(n=t.x-s),t.x+s>r&&(r=t.x+s),t.y-s<i&&(i=t.y-s),t.y+s>o&&(o=t.y+s))})),{xmin:n,xmax:r,ymin:i,ymax:o}}var h=n(6939);function f(t){let e=h.extend({btn_target:"pedigree_history"},t),n=[{fa:"fa-undo pull-left",title:"undo"},{fa:"fa-repeat pull-left",title:"redo"},{fa:"fa-refresh pull-left",title:"reset"}];n.push({fa:"fa-crosshairs pull-right",title:"scale-to-fit"}),e.zoomSrc&&e.zoomSrc.indexOf("button")>-1&&(1!=e.zoomOut&&n.push({fa:"fa-minus-circle pull-right",title:"zoom-out"}),1!=e.zoomIn&&n.push({fa:"fa-plus-circle pull-right",title:"zoom-in"})),n.push({fa:"fa-arrows-alt pull-right",title:"fullscreen"});let a="";for(let t=0;t<n.length;t++)a+="<span>",a+='&nbsp;<i class="fa fa-lg '+n[t].fa+'" '+("fa-arrows-alt pull-right"==n[t].fa?'id="fullscreen" ':"")+' aria-hidden="true" title="'+n[t].title+'"></i>',a+="</span>";h("#"+e.btn_target).append(a),function(t){h(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",(function(e){let n=i.Vk(t);null!=n&&(t.dataset=n),R(t),setTimeout((function(){u(t)}),500)})),h("#fullscreen").on("click",(function(e){if(d())document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{let e=h("#"+t.targetDiv)[0];e.requestFullscreen?e.requestFullscreen():document.documentElement.mozRequestFullScreen?e.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):document.documentElement.msRequestFullscreen&&e.msRequestFullscreen()}}));let e=0;function n(){l(t,1.05)}function a(){l(t,.95)}h(".fa-plus-circle, .fa-minus-circle").on("mousedown",(function(){e=setInterval(h(this).hasClass("fa-plus-circle")?n:a,50)})).on("mouseup mouseleave",(function(){clearInterval(e)})),h("#"+t.btn_target).on("click",(function(e){if(e.stopPropagation(),h(e.target).hasClass("disabled"))return!1;h(e.target).hasClass("fa-undo")?(t.dataset=i.Xp(t),h("#"+t.targetDiv).empty(),L(t)):h(e.target).hasClass("fa-repeat")?(t.dataset=i.lp(t),h("#"+t.targetDiv).empty(),L(t)):h(e.target).hasClass("fa-refresh")?h('<div id="msgDialog">Resetting the pedigree may result in loss of some data.</div>').dialog({title:"Confirm Reset",resizable:!1,height:"auto",width:400,modal:!0,buttons:{Continue:function(){!function(t,e){let n;if(e){let e=i.Vk(t),a=(0,r.KY)(e);n=a[(0,r.Kz)(a)],n.name="ch1",n.mother="f21",n.father="m21",i.Fx(t)}else n={name:"ch1",sex:"F",mother:"f21",father:"m21",proband:!0,status:"0",display_name:"me"},i.ZH(t);delete t.dataset;let a=h("input[name='default_fam']:checked");a.length>0&&"extended2"==a.val()?t.dataset=[{name:"wZA",sex:"M",top_level:!0,status:"0",display_name:"paternal grandfather"},{name:"MAk",sex:"F",top_level:!0,status:"0",display_name:"paternal grandmother"},{name:"zwB",sex:"M",top_level:!0,status:"0",display_name:"maternal grandfather"},{name:"dOH",sex:"F",top_level:!0,status:"0",display_name:"maternal grandmother"},{name:"MKg",sex:"F",mother:"MAk",father:"wZA",status:"0",display_name:"paternal aunt"},{name:"xsm",sex:"M",mother:"MAk",father:"wZA",status:"0",display_name:"paternal uncle"},{name:"m21",sex:"M",mother:"MAk",father:"wZA",status:"0",display_name:"father"},{name:"f21",sex:"F",mother:"dOH",father:"zwB",status:"0",display_name:"mother"},{name:"aOH",sex:"F",mother:"f21",father:"m21",status:"0",display_name:"sister"},{name:"Vha",sex:"M",mother:"f21",father:"m21",status:"0",display_name:"brother"},{name:"Spj",sex:"M",mother:"f21",father:"m21",noparents:!0,status:"0",display_name:"partner"},n,{name:"zhk",sex:"F",mother:"ch1",father:"Spj",status:"0",display_name:"daughter"},{name:"Knx",display_name:"son",sex:"M",mother:"ch1",father:"Spj",status:"0"},{name:"uuc",display_name:"maternal aunt",sex:"F",mother:"dOH",father:"zwB",status:"0"},{name:"xIw",display_name:"maternal uncle",sex:"M",mother:"dOH",father:"zwB",status:"0"}]:a.length>0&&"extended1"==a.val()?t.dataset=[{name:"m21",sex:"M",mother:null,father:null,status:"0",display_name:"father",noparents:!0},{name:"f21",sex:"F",mother:null,father:null,status:"0",display_name:"mother",noparents:!0},{name:"aOH",sex:"F",mother:"f21",father:"m21",status:"0",display_name:"sister"},{name:"Vha",sex:"M",mother:"f21",father:"m21",status:"0",display_name:"brother"},{name:"Spj",sex:"M",mother:"f21",father:"m21",noparents:!0,status:"0",display_name:"partner"},n,{name:"zhk",sex:"F",mother:"ch1",father:"Spj",status:"0",display_name:"daughter"},{name:"Knx",display_name:"son",sex:"M",mother:"ch1",father:"Spj",status:"0"}]:t.dataset=[{name:"m21",display_name:"father",sex:"M",top_level:!0},{name:"f21",display_name:"mother",sex:"F",top_level:!0},n];R(t)}(t,t.keep_proband_on_reset),h(this).dialog("close")},Cancel:function(){h(this).dialog("close")}}}):h(e.target).hasClass("fa-crosshairs")&&u(t),h(document).trigger("fhChange",[t])}))}(e)}function d(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}var p=n(10527),_=n(6939);function m(t){_("#orig_ashk").is(":checked")?_.each(t,(function(t,e){e.proband&&(e.ashkenazi=1)})):_.each(t,(function(t,e){delete e.ashkenazi}))}function y(t){_("#cancer .row").show(),"M"===t.sex?(delete t.ovarian_cancer_diagnosis_age,_("[id^='id_ovarian_cancer_diagnosis_age']").closest(".row").hide(),_("[id^='id_breast_cancer2_diagnosis_age']").prop("disabled",!0)):"F"===t.sex&&(delete t.prostate_cancer_diagnosis_age,_("[id^='id_prostate_cancer_diagnosis_age']").closest(".row").hide(),_("[id^='id_breast_cancer2_diagnosis_age']").prop("disabled",!1))}function g(t){let e=10*Math.round((t-1)/10);return t<e?e-5:e+5}_(document).on("fhChange",(function(t,e){try{let t=_("#id_name").val();void 0===(0,r.Lw)((0,i.Vk)(e),t)?_("form > fieldset").prop("disabled",!0):_("form > fieldset").prop("disabled",!1)}catch(t){console.warn(t)}}));var v=n(6939),x=n(44449);let w,b;function z(t,e){let n=parseInt(v("body").css("font-size")),a=x.select(".diagram");a.append("rect").attr("class","popup_selection").attr("rx",6).attr("ry",6).attr("transform","translate(-1000,-100)").style("opacity",0).attr("width",7.9*n).attr("height",2*n).style("stroke","darkgrey").attr("fill","white");let o=a.append("text").attr("font-family","FontAwesome").style("opacity",0).attr("font-size","1.em").attr("class","popup_selection fa-lg fa-square persontype").attr("transform","translate(-1000,-100)").attr("x",n/3).attr("y",1.5*n).text(" ").append("svg:title").text("add male"),s=a.append("text").attr("font-family","FontAwesome").style("opacity",0).attr("font-size","1.em").attr("class","popup_selection fa-lg fa-circle persontype").attr("transform","translate(-1000,-100)").attr("x",1.7*n).attr("y",1.5*n).text(" ").append("svg:title").text("add female");a.append("text").attr("font-family","FontAwesome").style("opacity",0).attr("font-size","1.em").attr("transform","translate(-1000,-100)").attr("class","popup_selection fa-lg fa-unspecified popup_selection_rotate45 persontype").text(" ").append("svg:title").text("add unspecified"),a.append("text").attr("font-family","FontAwesome").style("opacity",0).attr("transform","translate(-1000,-100)").attr("class","popup_selection fa-2x fa-angle-up persontype dztwin").attr("x",4.6*n).attr("y",1.5*n).text(" ").append("svg:title").text("add dizygotic/fraternal twins"),a.append("text").attr("font-family","FontAwesome").style("opacity",0).attr("transform","translate(-1000,-100)").attr("class","popup_selection fa-2x fa-caret-up persontype mztwin").attr("x",6.2*n).attr("y",1.5*n).text("").append("svg:title").text("add monozygotic/identical twins");let l={};x.selectAll(".persontype").on("click",(function(){let e,n,a=(0,r.KY)((0,i.Vk)(t)),o=x.select(this).classed("mztwin"),s=x.select(this).classed("dztwin");if(o||s?(n=l.node.datum().data.sex,e=o?"mztwin":"dztwin"):n=x.select(this).classed("fa-square")?"M":x.select(this).classed("fa-circle")?"F":"U","addsibling"===l.type)H(a,l.node.datum().data,n,!1,e);else{if("addchild"!==l.type)return;j(a,l.node.datum().data,e?"U":n,e?2:1,e)}t.dataset=a,R(t),x.selectAll(".popup_selection").style("opacity",0),l={}})).on("mouseover",(function(){l.node&&l.node.select("rect").style("opacity",.2),x.selectAll(".popup_selection").style("opacity",1),"addsibling"===l.type?x.select(this).classed("fa-square")?o.text("add brother"):s.text("add sister"):"addchild"===l.type&&(x.select(this).classed("fa-square")?o.text("add son"):s.text("add daughter"))})),x.selectAll(".popup_selection").on("mouseout",(function(){void 0!==l.node&&-1==d.indexOf(l.node.datum())&&l.node.select("rect").style("opacity",0),x.selectAll(".popup_selection").style("opacity",0)})),function(t){function e(){w=b,x.selectAll(".line_drag_selection").attr("stroke","darkred")}function n(e){if(b&&w.data.name!==b.data.name&&w.data.sex!==b.data.sex){let e={name:(0,r.YO)(4),sex:"U",mother:"F"===w.data.sex?w.data.name:b.data.name,father:"F"===w.data.sex?b.data.name:w.data.name},n=(0,r.KY)(t.dataset);t.dataset=n;let i=(0,r.qj)(t.dataset,w.data.name)+1;t.dataset.splice(i,0,e),R(t)}A(0,0,0,0),x.selectAll(".line_drag_selection").attr("stroke","black"),w=void 0}function i(e){x.event.sourceEvent.stopPropagation();let n=x.event.dx,r=x.event.dy,i=parseFloat(x.select(this).attr("x2"))+n,a=parseFloat(x.select(this).attr("y2"))+r;A(t.symbol_size-10,0,i,a)}x.select(".diagram").append("line").attr("class","line_drag_selection").attr("stroke-width",6).style("stroke-dasharray","2, 1").attr("stroke","black").call(x.drag().on("start",e).on("drag",i).on("end",n)).append("svg:title").text("drag to create consanguineous partners"),A(0,0,0,0)}(t),e.filter((function(e){return!(e.data.hidden&&!t.DEBUG)})).append("rect").attr("class","indi_rect").attr("rx",6).attr("ry",6).attr("x",(function(e){return-.75*t.symbol_size})).attr("y",(function(e){return-t.symbol_size})).attr("width",1.5*t.symbol_size+"px").attr("height",2*t.symbol_size+"px").style("stroke","black").style("stroke-width",.7).style("opacity",0).attr("fill","lightgrey");let u=function(e){return h-.75*t.symbol_size},c=t.symbol_size-2,h=0,f={addchild:{text:"",title:"add child",fx:u,fy:c},addsibling:{text:"",title:"add sibling",fx:u,fy:c},addpartner:{text:"",title:"add partner",fx:u,fy:c},addparents:{text:"",title:"add parents",fx:-.75*t.symbol_size,fy:11-t.symbol_size},delete:{text:"X",title:"delete",fx:t.symbol_size/2-1,fy:12-t.symbol_size,styles:{"font-weight":"bold",fill:"darkred","font-family":"monospace"}}};t.edit&&(f.settings={text:"",title:"settings",fx:-n/2+2,fy:11-t.symbol_size});for(let n in f){let r=e.filter((function(e){return!(e.data.hidden&&!t.DEBUG||(void 0===e.data.mother||e.data.noparents)&&"addsibling"===n||void 0!==e.data.parent_node&&e.data.parent_node.length>1&&"addpartner"===n||void 0===e.data.parent_node&&"addchild"===n||void 0===e.data.noparents&&void 0===e.data.top_level&&"addparents"===n)})).append("text").attr("class",n).style("opacity",0).attr("font-family","FontAwesome").attr("xx",(function(t){return t.x})).attr("yy",(function(t){return t.y})).attr("x",f[n].fx).attr("y",f[n].fy).attr("font-size","0.9em").text(f[n].text);if("styles"in f[n])for(let t in f[n].styles)r.attr(t,f[n].styles[t]);r.append("svg:title").text(f[n].title),h+=17}x.selectAll(".addsibling, .addchild").on("mouseover",(function(){let t=x.select(this).attr("class");x.selectAll(".popup_selection").style("opacity",1),l={node:x.select(this.parentNode),type:t};let e=parseInt(x.select(this).attr("xx"))+parseInt(x.select(this).attr("x")),r=parseInt(x.select(this).attr("yy"))+parseInt(x.select(this).attr("y"));x.selectAll(".popup_selection").attr("transform","translate("+e+","+(r+2)+")"),x.selectAll(".popup_selection_rotate45").attr("transform","translate("+(e+3*n)+","+(r+1.2*n)+") rotate(45)")})),x.selectAll(".addchild, .addpartner, .addparents, .delete, .settings").on("click",(function(){x.event.stopPropagation();let e,n=x.select(this).attr("class"),a=x.select(this.parentNode).datum();t.DEBUG&&console.log(n),"settings"===n?"function"==typeof t.edit?t.edit(t,a):function(t,e){v("#node_properties").dialog({autoOpen:!1,title:e.data.display_name,width:v(window).width()>400?450:v(window).width()-30});let n="<table id='person_details' class='table'>";n+="<tr><td style='text-align:right'>Unique ID</td><td><input class='form-control' type='text' id='id_name' name='name' value="+(e.data.name?e.data.name:"")+"></td></tr>",n+="<tr><td style='text-align:right'>Name</td><td><input class='form-control' type='text' id='id_display_name' name='display_name' value="+(e.data.display_name?e.data.display_name:"")+"></td></tr>",n+="<tr><td style='text-align:right'>Age</td><td><input class='form-control' type='number' id='id_age' min='0' max='120' name='age' style='width:7em' value="+(e.data.age?e.data.age:"")+"></td></tr>",n+="<tr><td style='text-align:right'>Year Of Birth</td><td><input class='form-control' type='number' id='id_yob' min='1900' max='2050' name='yob' style='width:7em' value="+(e.data.yob?e.data.yob:"")+"></td></tr>",n+='<tr><td colspan="2" id="id_sex"><label class="radio-inline"><input type="radio" name="sex" value="M" '+("M"===e.data.sex?"checked":"")+'>Male</label><label class="radio-inline"><input type="radio" name="sex" value="F" '+("F"===e.data.sex?"checked":"")+'>Female</label><label class="radio-inline"><input type="radio" name="sex" value="U">Unknown</label></td></tr>',n+='<tr><td colspan="2" id="id_status"><label class="checkbox-inline"><input type="radio" name="status" value="0" '+(0===parseInt(e.data.status)?"checked":"")+'>&thinsp;Alive</label><label class="checkbox-inline"><input type="radio" name="status" value="1" '+(1===parseInt(e.data.status)?"checked":"")+">&thinsp;Deceased</label></td></tr>",v("#id_status input[value='"+e.data.status+"']").prop("checked",!0);let a=["adopted_in","adopted_out","miscarriage","stillbirth","termination"];n+='<tr><td colspan="2"><strong>Reproduction:</strong></td></tr>',n+='<tr><td colspan="2">';for(let t=0;t<a.length;t++){let r=a[t];2===t&&(n+='</td></tr><tr><td colspan="2">'),n+='<label class="checkbox-inline"><input type="checkbox" id="id_'+r+'" name="'+r+'" value="0" '+(e.data[r]?"checked":"")+">&thinsp;"+E(r.replace("_"," "))+"</label>"}n+="</td></tr>";let o=["children","name","parent_node","top_level","id","noparents","level","age","sex","status","display_name","mother","father","yob","mztwin","dztwin"];v.merge(o,a),n+='<tr><td colspan="2"><strong>Age of Diagnosis:</strong></td></tr>',v.each(t.diseases,(function(r,i){o.push(i.type+"_diagnosis_age");let a='&thinsp;<span style="padding-left:5px;background:'+t.diseases[r].colour+'"></span>',s=e.data[i.type+"_diagnosis_age"];n+="<tr><td style='text-align:right'>"+E(i.type.replace("_"," "))+a+"&nbsp;</td><td><input class='form-control' id='id_"+i.type+"_diagnosis_age_0' max='110' min='0' name='"+i.type+"_diagnosis_age_0' style='width:5em' type='number' value='"+(void 0!==s?s:"")+"'></td></tr>"})),n+='<tr><td colspan="2" style="line-height:1px;"></td></tr>',v.each(e.data,(function(t,e){if(-1==v.inArray(t,o)){let r=E(t);!0===e||!1===e?n+="<tr><td style='text-align:right'>"+r+"&nbsp;</td><td><input type='checkbox' id='id_"+t+"' name='"+t+"' value="+e+" "+(e?"checked":"")+"></td></tr>":t.length>0&&(n+="<tr><td style='text-align:right'>"+r+"&nbsp;</td><td><input type='text' id='id_"+t+"' name='"+t+"' value="+e+"></td></tr>")}})),n+="</table>",v("#node_properties").html(n),v("#node_properties").dialog("open"),v("#node_properties input[type=radio], #node_properties input[type=checkbox], #node_properties input[type=text], #node_properties input[type=number]").change((function(){!function(t){let e=(0,i.Vk)(t),n=_("#id_name").val(),a=(0,r.KY)(e),o=(0,r.Lw)(a,n);if(!o)return void console.warn("person not found when saving details");_("#"+t.targetDiv).empty();let s=_("#id_yob_0").val();s&&""!==s?o.yob=s:delete o.yob;let l=_("#id_status").find("input[type='radio']:checked");l.length>0&&(o.status=l.val());let u=["miscarriage","adopted_in","adopted_out","termination","stillbirth"];for(let t=0;t<u.length;t++){let e=u[t],n=_("#id_"+e);n.length>0&&(console.log(n.is(":checked")),n.is(":checked")?o[e]=!0:delete o[e])}let c=_("#id_sex").find("input[type='radio']:checked");c.length>0&&(o.sex=c.val(),y(o)),m(a),_("#id_approx").is(":checked")?o.approx_diagnosis_age=!0:delete o.approx_diagnosis_age,_("#person_details select[name*='_diagnosis_age']:visible, #person_details input[type=text]:visible, #person_details input[type=number]:visible").each((function(){let t=this.name.indexOf("_diagnosis_age")>-1?this.name.substring(0,this.name.length-2):this.name;if(_(this).val()){let e=_(this).val();t.indexOf("_diagnosis_age")>-1&&_("#id_approx").is(":checked")&&(e=g(e)),o[t]=e}else delete o[t]})),_('#person_details input[type="checkbox"][name$="cancer"],input[type="checkbox"][name$="cancer2"]').each((function(){this.checked?o[_(this).attr("name")]=!0:delete o[_(this).attr("name")]})),_('#person_details select[name$="_bc_pathology"]').each((function(){"-"!==_(this).val()?o[_(this).attr("name")]=_(this).val():delete o[_(this).attr("name")]})),_('#person_details select[name$="_gene_test"]').each((function(){if("-"!==_(this).val()){let t=_('select[name="'+_(this).attr("name")+'_result"]');o[_(this).attr("name")]={type:_(this).val(),result:_(t).val()}}else delete o[_(this).attr("name")]}));try{_("#person_details").find("form").valid()}catch(t){console.warn("valid() not found")}V(a,o),t.dataset=a,R(t)}(t)}))}(t,a):"delete"===n?(e=(0,r.KY)((0,i.Vk)(t)),J(e,a.data,t,k)):"addparents"===n?(e=(0,r.KY)((0,i.Vk)(t)),t.dataset=e,X(t,e,a.data.name),R(t)):"addpartner"===n&&(e=(0,r.KY)((0,i.Vk)(t)),K(t,e,a.data.name),t.dataset=e,R(t)),v(document).trigger("fhChange",[t])}));let d=[];e.filter((function(t){return!t.data.hidden})).on("click",(function(e){x.event.ctrlKey?-1==d.indexOf(e)?d.push(e):d.splice(d.indexOf(e),1):d=[e],"nodeclick"in t&&(t.nodeclick(e.data),x.selectAll(".indi_rect").style("opacity",0),x.selectAll(".indi_rect").filter((function(t){return-1!=d.indexOf(t)})).style("opacity",.5))})).on("mouseover",(function(e){x.event.stopPropagation(),b=e,w?w.data.name!==b.data.name&&w.data.sex!==b.data.sex&&x.select(this).select("rect").style("opacity",.2):(x.select(this).select("rect").style("opacity",.2),x.select(this).selectAll(".addchild, .addsibling, .addpartner, .addparents, .delete, .settings").style("opacity",1),x.select(this).selectAll(".indi_details").style("opacity",0),A(t.symbol_size-10,0,t.symbol_size-2,0,e.x+","+(e.y+2)))})).on("mouseout",(function(e){if(w)return;x.select(this).selectAll(".addchild, .addsibling, .addpartner, .addparents, .delete, .settings").style("opacity",0),-1==d.indexOf(e)&&x.select(this).select("rect").style("opacity",0),x.select(this).selectAll(".indi_details").style("opacity",1);let n=x.mouse(this)[0],r=x.mouse(this)[1];r<.8*t.symbol_size&&x.selectAll(".popup_selection").style("opacity",0),w||(Math.abs(r)>.25*t.symbol_size||Math.abs(r)<-.25*t.symbol_size||n<.2*t.symbol_size)&&A(0,0,0,0)}))}function k(t,e){t.dataset=e,R(t)}function A(t,e,n,r,i){i&&x.selectAll(".line_drag_selection").attr("transform","translate("+i+")"),x.selectAll(".line_drag_selection").attr("x1",t).attr("y1",e).attr("x2",n).attr("y2",r)}function E(t){return t.charAt(0).toUpperCase()+t.slice(1)}var T=n(6939);function M(t,e){Z(t,e,-.4*t.symbol_size,-.1*t.symbol_size,(function(e){return t.DEBUG?("display_name"in e.data?e.data.display_name:e.data.name)+"  "+e.data.id:"display_name"in e.data?e.data.display_name:""}),void 0,["display_name"]);let n=parseInt(function(t){let e=t.font_size;if(e===parseInt(e,10))return e;if(e.indexOf("px")>-1)return e.replace("px","");if(-1===e.indexOf("em"))return e;return e=parseFloat(e.replace("em","")),parseFloat(getComputedStyle(T("#"+t.targetDiv).get(0)).fontSize)*e-1}(t))+4;for(let r=0;r<t.labels.length;r++){let i=t.labels[r],a=Array.isArray(i)?i:[i];(a.indexOf("age")>-1||a.indexOf("yob")>-1)&&Z(t,e,-t.symbol_size,(function(t){return N(t,a,n)}),(function(t){return S(t,a)}),"indi_details",a)}for(let r=0;r<t.diseases.length;r++){let i=t.diseases[r].type;Z(t,e,-t.symbol_size,(function(t){return N(t,[i],n)}),(function(t){let e=i.replace("_"," ").replace("cancer","ca.");return i+"_diagnosis_age"in t.data?e+": "+t.data[i+"_diagnosis_age"]:""}),"indi_details",[i])}for(let r=0;r<t.labels.length;r++){let i=t.labels[r],a=Array.isArray(i)?i:[i];-1===a.indexOf("age")&&-1===a.indexOf("yob")&&Z(t,e,-t.symbol_size,(function(t){return N(t,a,n)}),(function(t){return S(t,a)}),"indi_details",a)}}function S(t,e){let n="";for(let r=0;r<e.length;r++){let i=e[r];if(t.data[i])if("alleles"===i){let e=t.data.alleles.split(";");for(let t=0;t<e.length;t++)""!==e[t]&&(n+=e[t]+";")}else if("age"===i)n+=t.data[i]+"y ";else if("stillbirth"===i)n+="SB";else if(i.match("_gene_test$")&&"result"in t.data[i]){let e=t.data[i].result.toUpperCase();"-"!==e&&(n+=i.replace("_gene_test","").toUpperCase(),n+="P"===e?"+ ":"N"===e?"- ":" ")}else if(i.match("_bc_pathology$")){let e=t.data[i].toUpperCase();n+=i.replace("_bc_pathology","").toUpperCase(),n+="P"===e?"+ ":"N"===e?"- ":" "}else n+=t.data[i]}if(""!==n)return n}function N(t,e,n){if(O(t,e))return t.y_offset=t.y_offset?t.y_offset+n:2.35*n,t.y_offset}function O(t,e){for(let n=0;n<e.length;n++)if((0,r.UY)(e[n],t.data))return!0;return!1}function Z(t,e,n,r,i,a,o){e.filter((function(t){return!t.data.hidden&&(!o||O(t,o))})).append("text").attr("class",a?a+" ped_label":"ped_label").attr("x",n).attr("y",r).attr("font-family",t.font_family).attr("font-size",t.font_size).attr("font-weight",t.font_weight).text(i)}var C=n(6939),I=n(44449);let D={};function L(t){let e=C.extend({targetDiv:"pedigree_edit",dataset:[{name:"m21",display_name:"father",sex:"M",top_level:!0},{name:"f21",display_name:"mother",sex:"F",top_level:!0},{name:"ch1",display_name:"me",sex:"F",mother:"f21",father:"m21",proband:!0}],width:600,height:400,symbol_size:35,zoomSrc:["wheel","button"],zoomIn:1,zoomOut:1,diseases:[{type:"breast_cancer",colour:"#F68F35"},{type:"breast_cancer2",colour:"pink"},{type:"ovarian_cancer",colour:"#4DAA4D"},{type:"pancreatic_cancer",colour:"#4289BA"},{type:"prostate_cancer",colour:"#D5494A"}],labels:["stillbirth",["age","yob"],"alleles",["brca1_gene_test","brca2_gene_test","palb2_gene_test","chek2_gene_test","atm_gene_test"],["rad51d_gene_test","rad51c_gene_test","brip1_gene_test"],["er_bc_pathology","pr_bc_pathology","her2_bc_pathology","ck14_bc_pathology","ck56_bc_pathology"]],keep_proband_on_reset:!1,font_size:".75em",font_family:"Helvetica",font_weight:700,background:"#EEE",node_background:"#fdfdfd",validate:!0,DEBUG:!1},t);0===C("#fullscreen").length&&(f(e),p.IH(e)),-1==i.m6(e)&&i.k8(e),function(t){let e=i.bn(t),n=i.m6(t),r="#"+t.btn_target;n<=e?h(r+" .fa-repeat").addClass("disabled"):h(r+" .fa-repeat").removeClass("disabled"),e>1?h(r+" .fa-undo").removeClass("disabled"):h(r+" .fa-undo").addClass("disabled")}(e),F(e),e.dataset=function(t){for(let e=0;e<t.length;e++)2==r.hh(t,t[e].name)&&(t[e].top_level=!0);let e=[],n=[];for(let i=0;i<t.length;i++){let a=t[i];if("top_level"in a&&-1==C.inArray(a.name,n)){n.push(a.name),e.push(a);let i=r.UQ(t,a);for(let a=0;a<i.length;a++)-1==C.inArray(i[a],n)&&(n.push(i[a]),e.push(r.Lw(t,i[a])))}}let i=C.map(t,(function(t,e){return"top_level"in t&&t.top_level?null:t}));for(let t=e.length;t>0;--t)i.unshift(e[t-1]);return i}(e.dataset),e.DEBUG&&r.Tx(e);let n=U(e),a=I.select("#"+e.targetDiv).append("svg:svg").attr("width",n.width).attr("height",n.height);a.append("rect").attr("width","100%").attr("height","100%").attr("rx",6).attr("ry",6).style("stroke","darkgrey").style("fill",e.background).style("stroke-width",1);let o=a.append("g").attr("class","diagram"),l={name:"hidden_root",id:0,hidden:!0,children:C.map(e.dataset,(function(t,e){return"top_level"in t&&t.top_level?t:null}))},u=r.fX(e,l,l)[0],c=I.hierarchy(l);D[e.targetDiv]=c;let d=Y(e);e.DEBUG&&console.log("opts.width="+n.width+" width="+d.width+" opts.height="+n.height+" height="+d.height);let _=I.tree().separation((function(t,e){return t.parent===e.parent||t.data.hidden||e.data.hidden?1.2:2.2})).size([d.width,d.height])(c.sort((function(t,e){return t.data.id-e.data.id}))),m=_.descendants();if(C.map(e.dataset,(function(t,e){return t.hidden?null:t})).length!=e.dataset.length)throw B("NUMBER OF VISIBLE NODES DIFFERENT TO NUMBER IN THE DATASET");r.e3(e,_,m);let y=r.Yc(m,u);!function(t,e){for(let n=0;n<e.length;n++){let r=q(t,e[n]);r&&console.log("CLASH :: "+e[n].mother.data.name+" "+e[n].father.data.name,r)}}(e,y);let g=o.selectAll(".node").data(_.descendants()).enter().append("g").attr("transform",(function(t,e){return"translate("+t.x+","+t.y+")"}));g.filter((function(t){return!t.data.hidden})).append("path").attr("shape-rendering","geometricPrecision").attr("transform",(function(t){return"U"!=t.data.sex||t.data.miscarriage||t.data.termination?"":"rotate(45)"})).attr("d",I.symbol().size((function(t){return e.symbol_size*e.symbol_size+2})).type((function(t){return t.data.miscarriage||t.data.termination?I.symbolTriangle:"F"==t.data.sex?I.symbolCircle:I.symbolSquare}))).style("stroke",(function(t){return t.data.age&&t.data.yob&&!t.data.exclude?"#303030":"grey"})).style("stroke-width",(function(t){return t.data.age&&t.data.yob&&!t.data.exclude?".3em":".1em"})).style("stroke-dasharray",(function(t){return t.data.exclude?"3, 3":null})).style("fill","none"),g.filter((function(t){return!(t.data.hidden&&!e.DEBUG)})).append("clipPath").attr("id",(function(t){return t.data.name})).append("path").attr("class","node").attr("transform",(function(t){return"U"!=t.data.sex||t.data.miscarriage||t.data.termination?"":"rotate(45)"})).attr("d",I.symbol().size((function(t){return t.data.hidden?e.symbol_size*e.symbol_size/5:e.symbol_size*e.symbol_size})).type((function(t){return t.data.miscarriage||t.data.termination?I.symbolTriangle:"F"==t.data.sex?I.symbolCircle:I.symbolSquare}))),g.filter((function(t){return!(t.data.hidden&&!e.DEBUG)})).selectAll("pienode").data((function(t){let n=0,i=C.map(e.diseases,(function(i,a){return r.UY(e.diseases[a].type,t.data)?(n++,1):0}));return 0===n&&(i=[1]),[C.map(i,(function(e,r){return{cancer:e,ncancers:n,id:t.data.name,sex:t.data.sex,proband:t.data.proband,hidden:t.data.hidden,affected:t.data.affected,exclude:t.data.exclude}}))]})).enter().append("g").selectAll("path").data(I.pie().value((function(t){return t.cancer}))).enter().append("path").attr("clip-path",(function(t){return"url(#"+t.data.id+")"})).attr("class","pienode").attr("d",I.arc().innerRadius(0).outerRadius(e.symbol_size)).style("fill",(function(t,n){return t.data.exclude?"lightgrey":0===t.data.ncancers?t.data.affected?"darkgrey":e.node_background:e.diseases[n].colour})),g.filter((function(t){return!t.data.hidden&&(t.data.adopted_in||t.data.adopted_out)})).append("path").attr("d",(function(t){{let t=-.66*e.symbol_size,n=-.64*e.symbol_size,r=e.symbol_size/4;return P(t,n,r,e)+P(-t,n,-r,e)}})).style("stroke",(function(t){return t.data.age&&t.data.yob&&!t.data.exclude?"#303030":"grey"})).style("stroke-width",(function(t){return".1em"})).style("stroke-dasharray",(function(t){return t.data.exclude?"3, 3":null})).style("fill","none"),g.filter((function(t){return 1==t.data.status})).append("line").style("stroke","black").attr("x1",(function(t,n){return-.6*e.symbol_size})).attr("y1",(function(t,n){return.6*e.symbol_size})).attr("x2",(function(t,n){return.6*e.symbol_size})).attr("y2",(function(t,n){return-.6*e.symbol_size})),M(e,g),z(e,g);let v={},x=function(t,e,n,r,i,a){let o=function(t,e){return t+1<e?o(++t):t},s="";for(let l=0;l<t.length;l++){let u=o(l,t.length),c=t[l]-e-a,h=t[u]+e+a;i.x>c&&i.x<h&&(i.y=r),s+="L"+c+","+(n-a)+"L"+c+","+(r-a)+"L"+h+","+(r-a)+"L"+h+","+(n-a),l=u}return s};u=o.selectAll(".partner").data(y).enter().insert("path","g").attr("fill","none").attr("stroke","#000").attr("shape-rendering","auto").attr("d",(function(t,n){let i,a,o,s=r.Lw(m,t.mother.data.name),l=r.Lw(m,t.father.data.name),u=r._L(s,l,e),c=t.mother.data.divorced&&t.mother.data.divorced===t.father.data.name,h=t.mother.x<t.father.x?t.mother.x:t.father.x,f=t.mother.x<t.father.x?t.father.x:t.mother.x,d=t.mother.y,p=q(e,t),_="";if(p){t.mother.depth in v?v[t.mother.depth]+=4:v[t.mother.depth]=4,d-=v[t.mother.depth],a=v[t.mother.depth]+e.symbol_size/2+2;let n=t.mother.data.parent_node,s=n[0];for(let e=0;e<n.length;e++)n[e].father.name===t.father.data.name&&n[e].mother.name===t.mother.data.name&&(s=n[e].name);o=r.Lw(m,s),o.y=d,p.sort((function(t,e){return t-e})),i=d-e.symbol_size/2-3,_=x(p,a,d,i,o,0)}let y="";if(c&&!p&&(y="M"+(h+.66*(f-h)+6)+","+(d-6)+"L"+(h+.66*(f-h)-6)+","+(d+6)+"M"+(h+.66*(f-h)+10)+","+(d-6)+"L"+(h+.66*(f-h)-2)+","+(d+6)),u){d=t.mother.x<t.father.x?t.mother.y:t.father.y,i=t.mother.x<t.father.x?t.father.y:t.mother.y;let e=3;if(Math.abs(d-i)>.1)return"M"+h+","+d+"L"+f+","+i+"M"+h+","+(d-e)+"L"+f+","+(i-e);return"M"+h+","+d+_+"L"+f+","+d+"M"+h+","+(d-e)+(p?x(p,a,d,i,o,e):"")+"L"+f+","+(d-e)+y}return"M"+h+","+d+_+"L"+f+","+d+y})),o.selectAll(".link").data(c.links(_.descendants())).enter().filter((function(t){return e.DEBUG||void 0===t.target.data.noparents&&null!==t.source.parent&&!t.target.data.hidden})).insert("path","g").attr("fill","none").attr("stroke-width",(function(t,n){return void 0!==t.target.data.noparents||null===t.source.parent||t.target.data.hidden?1:e.DEBUG?2:1})).attr("stroke",(function(t,e){return void 0!==t.target.data.noparents||null===t.source.parent||t.target.data.hidden?"pink":"#000"})).attr("stroke-dasharray",(function(t,n){if(!t.target.data.adopted_in)return null;let i=Math.abs(t.source.y-(t.source.y+t.target.y)/2),a=[i,0,Math.abs(t.source.x-t.target.x),0];r.Cz(e.dataset,t.target.data).length>=1&&(i*=3);for(let t=0;t<i;t+=10)C.merge(a,[5,5]);return a})).attr("shape-rendering",(function(t,e){return t.target.data.mztwin||t.target.data.dztwin?"geometricPrecision":"auto"})).attr("d",(function(t,n){if(t.target.data.mztwin||t.target.data.dztwin){let n=r.Cz(e.dataset,t.target.data);if(n.length>=1){let i=0,a=t.target.x,o=t.target.x;for(let t=0;t<n.length;t++){let e=r.Lw(m,n[t].name).x;a>e&&(a=e),o<e&&(o=e),i+=e}let s=(t.target.x+i)/(n.length+1),l=(t.source.y+t.target.y)/2,u="";if(a===t.target.x&&t.target.data.mztwin){let n=(s+t.target.x)/2,r=(l+(t.target.y-e.symbol_size/2))/2;u="M"+n+","+r+"L"+(s+(s-n))+" "+r}return"M"+t.source.x+","+t.source.y+"V"+l+"H"+s+"L"+t.target.x+" "+(t.target.y-e.symbol_size/2)+u}}if(t.source.data.mother){let e=r.Lw(m,t.source.data.mother.name),n=r.Lw(m,t.source.data.father.name);if(e.depth!==n.depth)return"M"+t.source.x+","+(e.y+n.y)/2+"H"+t.target.x+"V"+t.target.y}return"M"+t.source.x+","+t.source.y+"V"+(t.source.y+t.target.y)/2+"H"+t.target.x+"V"+t.target.y}));let w=r.Kz(e.dataset);if(void 0!==w){let t=r.Lw(m,e.dataset[w].name),n="triangle"+r.YO(3);o.append("svg:defs").append("svg:marker").attr("id",n).attr("refX",6).attr("refY",6).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d","M 0 0 12 6 0 12 3 6").style("fill","black"),o.append("line").attr("x1",t.x-e.symbol_size/.7).attr("y1",t.y+e.symbol_size/1.4).attr("x2",t.x-e.symbol_size/1.4).attr("y2",t.y+e.symbol_size/4).attr("stroke-width",1).attr("stroke","black").attr("marker-end","url(#"+n+")")}return s(e,a),e}function B(t){return console.error(t),new Error(t)}function F(t){if(t.validate){if("function"==typeof t.validate)return t.DEBUG&&console.log("CALLING CONFIGURED VALIDATION FUNCTION"),t.validate.call(this,t);let e,n=[],i=[];for(let a=0;a<t.dataset.length;a++){if(!a.hidden&&(t.dataset[a].mother||t.dataset[a].father)){e=t.dataset[a].display_name,e||(e="unnamed"),e+=" (IndivID: "+t.dataset[a].name+")";let n=t.dataset[a].mother,i=t.dataset[a].father;if(!n||!i)throw B("Missing parent for "+e);let o=r.qj(t.dataset,n),s=r.qj(t.dataset,i);if(-1===o)throw B("The mother (IndivID: "+n+") of family member "+e+" is missing from the pedigree.");if(-1===s)throw B("The father (IndivID: "+i+") of family member "+e+" is missing from the pedigree.");if("F"!==t.dataset[o].sex)throw B("The mother of family member "+e+" is not specified as female. All mothers in the pedigree must have sex specified as 'F'.");if("M"!==t.dataset[s].sex)throw B("The father of family member "+e+" is not specified as male. All fathers in the pedigree must have sex specified as 'M'.")}if(!t.dataset[a].name)throw B(e+" has no IndivID.");if(C.inArray(t.dataset[a].name,n)>-1)throw B("IndivID for family member "+e+" is not unique.");n.push(t.dataset[a].name),-1===C.inArray(t.dataset[a].famid,i)&&t.dataset[a].famid&&i.push(t.dataset[a].famid)}if(i.length>1)throw B("More than one family found: "+i.join(", ")+".");let a=r.py(t.dataset);a.length>0&&console.warn("individuals unconnected to pedigree ",a)}}function P(t,e,n,r){return"M"+(t+n)+","+e+"L"+t+" "+e+"L"+t+" "+(e+1.28*r.symbol_size)+"L"+t+" "+(e+1.28*r.symbol_size)+"L"+(t+n)+","+(e+1.28*r.symbol_size)}function q(t,e){let n,i,a=D[t.targetDiv],o=r.xH(a);if("name"in e){if(!("mother"in(e=r.Lw(o,e.name)).data))return null;n=r.Lw(o,e.data.mother),i=r.Lw(o,e.data.father)}else n=e.mother,i=e.father;let s=n.x<i.x?n.x:i.x,l=n.x<i.x?i.x:n.x,u=n.y,c=C.map(o,(function(t,e){return!t.data.hidden&&t.data.name!==n.data.name&&t.data.name!==i.data.name&&t.y==u&&t.x>s&&t.x<l?t.x:null}));return c.length>0?c:null}function U(t){return{width:d()?window.innerWidth:t.width,height:d()?window.innerHeight:t.height}}function Y(t){let e=U(t),n=0,i={};for(let e=0;e<t.dataset.length;e++){let a=r.hh(t.dataset,t.dataset[e].name),o=r.nI(t.dataset,t.dataset[e]),s=1+(o.length>0?.55+.25*o.length:0)+(t.dataset[e].father?.25:0);a in i?i[a]+=s:i[a]=s,i[a]>n&&(n=i[a])}let a=Object.keys(i).length*t.symbol_size*3.5;return{width:e.width-t.symbol_size>n*t.symbol_size*1.65?e.width-t.symbol_size:n*t.symbol_size*1.65,height:e.height-t.symbol_size>a?e.height-t.symbol_size:a}}function R(t){C("#"+t.targetDiv).empty(),i.k8(t);try{L(t)}catch(t){throw console.error(t),t}try{templates.update(t)}catch(t){}}function j(t,e,n,i,a){if(a&&-1===C.inArray(a,["mztwin","dztwin"]))return new Error("INVALID TWIN TYPE SET: "+a);void 0===i&&(i=1);let o,s,l,u=r.nI(t,e);if(0===u.length){let n=H(t,e,"F"===e.sex?"M":"F","F"===e.sex);n.noparents=!0,o=n.name,s=r.qj(t,e.name)+1}else{let n=u[0];o=n.father===e.name?n.mother:n.father,s=r.qj(t,n.name)}a&&(l=G(t,a));let c=[];for(let u=0;u<i;u++){let i={name:r.YO(4),sex:n,mother:"F"===e.sex?e.name:o,father:"F"===e.sex?o:e.name};t.splice(s,0,i),a&&(i[a]=l),c.push(i)}return c}function H(t,e,n,i,a){if(a&&-1===C.inArray(a,["mztwin","dztwin"]))return new Error("INVALID TWIN TYPE SET: "+a);let o={name:r.YO(4),sex:n};e.top_level?o.top_level=!0:(o.mother=e.mother,o.father=e.father);let s=r.qj(t,e.name);return a&&function(t,e,n,r){if(!e[r]&&(e[r]=G(t,r),!e[r]))return!1;n[r]=e[r],e.yob&&(n.yob=e.yob);!e.age||0!=e.status&&e.status||(n.age=e.age)}(t,t[s],o,a),i?s>0&&s--:s++,t.splice(s,0,o),o}function G(t,e){let n=[1,2,3,4,5,6,7,8,9,"A"];for(let r=0;r<t.length;r++)if(t[r][e]){let i=n.indexOf(t[r][e]);i>-1&&n.splice(i,1)}if(n.length>0)return n[0]}function V(t,e){if(!e.mztwin&&!e.dztwin)return;let n=e.mztwin?"mztwin":"dztwin";for(let r=0;r<t.length;r++){let i=t[r];i[n]&&e[n]==i[n]&&i.name!==e.name&&("mztwin"===n&&(i.sex=e.sex),e.yob&&(i.yob=e.yob),!e.age||0!=e.status&&e.status||(i.age=e.age))}}function X(t,e,n){let i,a,o,s,l=D[t.targetDiv],u=r.xH(l),c=r.Lw(u,n),h=c.data,f=c.depth,d=-101,p=r.nI(e,h);if(p.length>0&&(o=p[0].mother==h.name?p[0].father:p[0].mother,d=r.Lw(u,o).data.id),1==f)for(i={name:r.YO(4),sex:"F",top_level:!0},a={name:r.YO(4),sex:"M",top_level:!0},e.splice(0,0,i),e.splice(0,0,a),s=0;s<e.length;s++)e[s].top_level&&e[s].name!==i.name&&e[s].name!==a.name&&(delete e[s].top_level,e[s].noparents=!0,e[s].mother=i.name,e[s].father=a.name);else{let n=r.Lw(u,c.data.mother),o=r.Lw(u,c.data.father),l=r.Dc(e,h),f=1e4,p=c.data.id;for(s=0;s<l.length;s++){let t=r.Lw(u,l[s].name).data.id;t<f&&t>c.data.id&&(f=t),t<p&&(p=t)}let _,m=p>=c.data.id||d==p&&f<1e4;t.DEBUG&&console.log("lid="+p+" rid="+f+" nid="+c.data.id+" ADD_LHS="+m),_=!m&&o.data.id>n.data.id||m&&o.data.id<n.data.id?r.qj(e,h.father):r.qj(e,h.mother);let y=e[_];a=H(e,y,"M",m),i=H(e,y,"F",m);let g=r.qj(e,a.name),v=r.qj(e,i.name);if(g>v){let t=e[g];e[g]=e[v],e[v]=t}let x=r.d$(e,h),w=c.data.id;for(s=0;s<x.length;s++){let n=r.Lw(u,x[s].name).data.id;if(t.DEBUG&&console.log("ORPHAN="+s+" "+x[s].name+" "+(w<n&&n<f)+" nid="+w+" oid="+n+" rid="+f),(m||w<n)&&n<f){let t=r.qj(e,x[s].name);e[t].mother=i.name,e[t].father=a.name}}}2==f?(i.top_level=!0,a.top_level=!0):f>2&&(i.noparents=!0,a.noparents=!0);let _=r.qj(e,h.name);if(e[_].mother=i.name,e[_].father=a.name,delete e[_].noparents,"parent_node"in h){let t=e[r.qj(e,o)];"noparents"in t&&(t.mother=i.name,t.father=a.name)}}function K(t,e,n){let i=D[t.targetDiv],a=r.xH(i),o=r.Lw(a,n),s=H(e,o.data,"F"===o.data.sex?"M":"F","F"===o.data.sex);s.noparents=!0;let l={name:r.YO(4),sex:"M"};l.mother="F"===o.data.sex?o.data.name:s.name,l.father="F"===o.data.sex?s.name:o.data.name;let u=r.qj(e,o.data.name)+2;e.splice(u,0,l)}function W(t,e,n){let i,a,o=r.Ec(r.xH(t),e.depth,n);for(let t=0;t<o.length;t++)o[t].x<e.x&&(i=o[t]),!a&&o[t].x>e.x&&(a=o[t]);return[i,a]}function J(t,e,n,i){let a,o,s,l=D[n.targetDiv],u=r.xH(l),c=[];if(void 0===e.id){let t=r.Lw(u,e.name);void 0!==t&&(e=t.data)}if(e.parent_node)for(a=0;a<e.parent_node.length;a++){let n=e.parent_node[a],i=[r.Lw(t,n.mother.name),r.Lw(t,n.father.name)];for(o=0;o<i.length;o++)(i[o].name===e.name||void 0!==i[o].noparents||i[o].top_level)&&(t.splice(r.qj(t,i[o].name),1),c.push(i[o]));let s=n.children,h=C.map(s,(function(t,e){return t.name}));for(o=0;o<s.length;o++){let e=r.Lw(t,s[o].name);if(e){e.noparents=!0;let n,i=r.UQ(t,e);if(i.length>0&&(n=r.Lw(t,i[0])),n&&n.mother!==e.mother)e.mother=n.mother,e.father=n.father;else if(n){let t=W(l,r.Lw(u,e.name),h);e.mother=t[0]?t[0].data.mother:t[1]?t[1].data.mother:null,e.father=t[0]?t[0].data.father:t[1]?t[1].data.father:null}else t.splice(r.qj(t,e.name),1)}}}else t.splice(r.qj(t,e.name),1);for(console.log(c),a=0;a<c.length;a++){let e=c[a],n=r.Dc(t,e);if(console.log("DEL",e.name,n),n.length<1){console.log("del sibs",e.name,n);let i=r.Lw(u,e.name).ancestors();for(o=0;o<i.length;o++)console.log(i[a]),i[o].data.mother&&(console.log("DELETE ",i[o].data.mother,i[o].data.father),t.splice(r.qj(t,i[o].data.mother.name),1),t.splice(r.qj(t,i[o].data.father.name),1))}}!function(t){let e=["mztwin","dztwin"];for(let n=0;n<t.length;n++)for(let r=0;r<e.length;r++){let i=e[r];if(t[n][i]){let e=0;for(let r=0;r<t.length;r++)t[r][i]==t[n][i]&&e++;e<2&&delete t[n][[i]]}}}(t);try{let e=C.extend({},n);e.dataset=r.KY(t),F(e),s=r.py(t)}catch(t){throw r.sY("Warning","Deletion of this pedigree member is disallowed."),t}return s.length>0&&0===r.py(n.dataset).length?(console.error("individuals unconnected to pedigree ",s),void r.sY("Warning","Deleting this will split the pedigree. Continue?",i,n,t)):(i&&i(n,t),t)}},91843:function(t,e,n){"use strict";n.d(e,{w1:function(){return i},un:function(){return a},KY:function(){return o},UY:function(){return s},sY:function(){return l},YO:function(){return u},fX:function(){return c},IL:function(){return d},UQ:function(){return m},py:function(){return y},Kz:function(){return g},Dc:function(){return x},Cz:function(){return w},d$:function(){return b},nI:function(){return z},hh:function(){return k},qj:function(){return A},Ec:function(){return E},Yc:function(){return T},_L:function(){return S},xH:function(){return N},e3:function(){return O},Lw:function(){return C},Tx:function(){return I}});n(85516),n(56327);var r=n(6939);function i(){let t=navigator.userAgent;return t.indexOf("MSIE ")>-1||t.indexOf("Trident/")>-1}function a(){return navigator.userAgent.match(/Edge/g)}function o(t){t[0].id&&t.sort((function(t,e){return t.id&&e.id?t.id>e.id?1:e.id>t.id?-1:0:0}));let e=["id","parent_node"],n=[];for(let r=0;r<t.length;r++){let i={};for(let n in t[r])-1==e.indexOf(n)&&(i[n]=t[r][n]);n.push(i)}return n}function s(t,e){let n=!1;return e&&r.each(e,(function(e,r){if(0===e.indexOf(t+"_")||e===t)return n=!0,n})),n}function l(t,e,n,r,i){n?!0===confirm(e)&&n(r,i):alert(e)}function u(t){let e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(let r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}function c(t,e,n,i,a){void 0===e.children&&(e.children=v(t.dataset,e)),void 0===i&&(i=[],a=1);let o=N(n),s=[];return r.each(e.children,(function(e,n){r.each(t.dataset,(function(e,r){if((n.name===r.mother||n.name===r.father)&&void 0===n.id){let e=C(o,r.mother),n=C(o,r.father);e=void 0!==e?e:C(t.dataset,r.mother),n=void 0!==n?n:C(t.dataset,r.father),function(t,e,n){for(let r=0;r<t.length;r++)if(t[r].mother===e&&t[r].father===n)return!0;return!1}(s,e,n)||s.push({mother:e,father:n})}}))})),r.merge(i,s),r.each(s,(function(n,r){let i=r.mother,s=r.father;i.children=[];let l={name:u(4),hidden:!0,parent:null,father:s,mother:i,children:v(t.dataset,i,s)},c=A(t.dataset,i.name),d=A(t.dataset,s.name);"id"in s||"id"in i||(a=f(e.children,a));let p=function(t,e,n){let r=e,i=n;for(;"mother"in t[r]&&"mother"in t[i]&&!("noparents"in t[r])&&!("noparents"in t[i]);)r=A(t,t[r].mother),i=A(t,t[i].mother);return{midx:r,fidx:i}}(t.dataset,c,d);p.fidx<p.midx?(s.id=a++,l.id=a++,i.id=a++):(i.id=a++,l.id=a++,s.id=a++),a=h(i,l,a,o,t),a=h(s,l,a,o,t),e.children.push(l)})),a=f(e.children,a),r.each(e.children,(function(e,r){a=c(t,r,n,i,a)[1]})),[i,a]}function h(t,e,n,r,i){if("parent_node"in t?t.parent_node.push(e):t.parent_node=[e],t.mztwin||t.dztwins){let e=w(i.dataset,t);for(let t=0;t<e.length;t++){let i=C(r,e[t].name);i&&(i.id=n++)}}return n}function f(t,e){return t.sort((function(t,e){return t.mztwin&&e.mztwin&&t.mztwin==e.mztwin||t.dztwin&&e.dztwin&&t.dztwin==e.dztwin?0:t.mztwin||e.mztwin||t.dztwin||e.dztwin?1:0})),r.each(t,(function(t,n){void 0===n.id&&(n.id=e++)})),e}function d(t){return void 0!==r(t).attr("proband")&&!1!==r(t).attr("proband")}function p(t,e){for(let n=0;n<e.length;n++)-1==r.inArray(e[n],t)&&t.push(e[n])}function _(t,e,n){if(-1==r.inArray(e.name,t))return;p(t,m(n,e));let i=z(n,e);r.each(i,(function(e,i){-1==r.inArray(i.name,t)&&(t.push(i.name),p(t,m(n,i)))}))}function m(t,e){let n=[];for(let i=0;i<t.length;i++){let a=t[i];e.name===a.mother&&-1==r.inArray(a.father,n)?n.push(a.father):e.name===a.father&&-1==r.inArray(a.mother,n)&&n.push(a.mother)}return n}function y(t){let e=t[g(t)];if(!e){if(console.warn("No target defined"),0==t.length)throw"empty pedigree data set";e=t[0]}let n=[e.name],i=!0,a=0;for(;i&&a<200;){a++;let o=n.length;r.each(t,(function(i,a){if(-1!=r.inArray(a.name,n)){let i=m(t,a),o=a.name===e.name||!a.noparents;for(let e=0;e<i.length;e++)C(t,i[e]).noparents||(o=!0);o&&(a.mother&&-1==r.inArray(a.mother,n)&&n.push(a.mother),a.father&&-1==r.inArray(a.father,n)&&n.push(a.father))}else!a.noparents&&(a.mother&&-1!=r.inArray(a.mother,n)||a.father&&-1!=r.inArray(a.father,n))&&n.push(a.name);_(n,a,t)})),i=o!=n.length}let o=r.map(t,(function(t,e){return t.name}));return r.map(o,(function(t,e){return-1==r.inArray(t,n)?t:null}))}function g(t){let e;return r.each(t,(function(t,n){if(d(n))return e=t,e})),e}function v(t,e,n){let i=[],a=[];return"F"===e.sex&&r.each(t,(function(t,o){e.name===o.mother&&(n&&n.name!=o.father||-1===r.inArray(o.name,a)&&(i.push(o),a.push(o.name)))})),i}function x(t,e,n){return r.map(t,(function(t,r){return t.name===e.name||"noparents"in t||!t.mother||t.mother!==e.mother||t.father!==e.father||n&&t.sex!=n?null:t}))}function w(t,e){let n=function(t,e,n){return void 0===e||!e.mother||e.noparents?[]:r.map(t,(function(t,r){return t.name===e.name||"noparents"in t||!t.mother||t.mother!==e.mother||t.father!==e.father||n&&t.sex!=n?null:t}))}(t,e),i=e.mztwin?"mztwin":"dztwin";return r.map(n,(function(t,n){return t.name!==e.name&&t[i]==e[i]?t:null}))}function b(t,e){return r.map(t,(function(t,n){return t.name!==e.name&&"noparents"in t&&t.mother===e.mother&&t.father===e.father?t:null}))}function z(t,e,n){return r.map(t,(function(t,r){return"noparents"in t||t.mother!==e.name&&t.father!==e.name||n&&t.sex!==n?null:t}))}function k(t,e){let n=A(t,e),r=1;for(;n>=0&&("mother"in t[n]||t[n].top_level);)n=A(t,t[n].mother),r++;return r}function A(t,e){let n=-1;return r.each(t,(function(t,r){if(e===r.name)return n=t,n})),n}function E(t,e,n){return r.map(t,(function(t,i){return t.depth!=e||t.data.hidden||-1!=r.inArray(t.data.name,n)?null:t})).sort((function(t,e){return t.x-e.x}))}function T(t,e){let n=[];for(let r=0;r<e.length;r++)n.push({mother:C(t,e[r].mother.name),father:C(t,e[r].father.name)});return n}function M(t,e){let n=[];return function e(r){r.data&&(r=r.data),"mother"in r&&"father"in r&&!("noparents"in r)&&(e(C(t,r.mother)),e(C(t,r.father))),n.push(r)}(e),n}function S(t,e,n){if(t.depth!==e.depth)return!0;let i=M(n.dataset,t),a=M(n.dataset,e),o=r.map(i,(function(t,e){return t.name})),s=r.map(a,(function(t,e){return t.name})),l=!1;return r.each(o,(function(t,e){if(-1!==r.inArray(e,s))return l=!0,!1})),l}function N(t){let e=[];return function t(n){n.children&&n.children.forEach(t),e.push(n)}(t),e}function O(t,e,n){function i(a){if(a.children&&(a.children.forEach(i),void 0!==a.data.father)){let i=C(n,a.data.father.name),o=C(n,a.data.mother.name),s=(i.x+o.x)/2;if(Z(t,e.descendants(),s,a.depth,[a.data.name]))(a.x<i.x&&a.x<o.x||a.x>i.x&&a.x>o.x)&&(a.x=s);else{a.x=s;let n=a.x-s;if(2==a.children.length&&(a.children[0].data.hidden||a.children[1].data.hidden)){if(!a.children[0].data.hidden||!a.children[1].data.hidden){let n=a.children[0].data.hidden?a.children[1]:a.children[0],r=a.children[0].data.hidden?a.children[0]:a.children[1];(n.x<r.x&&s<r.x||n.x>r.x&&s>r.x)&&!Z(t,e.descendants(),s,n.depth,[n.data.name])&&(n.x=s)}}else if(1!=a.children.length||a.children[0].data.hidden){if(0!==n&&!function(t,e,n,i){let a=e.descendants(),o=r.map(a,(function(t,e){return t.data.name})),s=i.descendants();for(let r=0;r<a.length;r++){let i=a[r];if(e.data.name!==i.data.name){if(Z(t,s,i.x-n,i.depth,o))return!0}}return!1}(t,a,n,e))if(1==a.children.length)a.children[0].x=s;else{let e=a.descendants();t.DEBUG&&console.log("ADJUSTING "+a.data.name+" NO. DESCENDANTS "+e.length+" diff="+n);for(let t=0;t<e.length;t++)a.data.name!==e[t].data.name&&(e[t].x-=n)}}else Z(t,e.descendants(),s,a.children[0].depth,[a.children[0].data.name])||(a.children[0].x=s)}}}i(e),i(e)}function Z(t,e,n,i,a){for(let o=0;o<e.length;o++)if(i==e[o].depth&&-1==r.inArray(e[o].data.name,a)&&Math.abs(n-e[o].x)<1.15*t.symbol_size)return!0;return!1}function C(t,e){for(let n=0;n<t.length;n++){if(t[n].data&&e===t[n].data.name)return t[n];if(e===t[n].name)return t[n]}}function I(t){let e;r("#pedigree_data").remove(),r("body").append("<div id='pedigree_data'></div>");for(let n=0;n<t.dataset.length;n++){let i="<div class='row'><strong class='col-md-1 text-right'>"+t.dataset[n].name+"</strong><div class='col-md-11'>";for(e in t.dataset[n])"name"!==e&&("parent"===e?i+="<span>"+e+":"+t.dataset[n][e].name+"; </span>":"children"===e?void 0!==t.dataset[n][e][0]&&(i+="<span>"+e+":"+t.dataset[n][e][0].name+"; </span>"):i+="<span>"+e+":"+t.dataset[n][e]+"; </span>");r("#pedigree_data").append(i+"</div></div>")}for(e in r("#pedigree_data").append("<br /><br />"),t)"dataset"!==e&&r("#pedigree_data").append("<span>"+e+":"+t[e]+"; </span>")}},18063:function(t,e,n){!function(t,e){"use strict";function n(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var r=n(e);function i(t,e){return i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,i(t,e)}var o=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=[]),t.length!==e.length||t.some((function(t,n){return!Object.is(t,e[n])}))},s={error:null},l=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).state=s,e.updatedWithError=!1,e.resetErrorBoundary=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null==e.props.onReset||(t=e.props).onReset.apply(t,r),e.reset()},e}a(e,t),e.getDerivedStateFromError=function(t){return{error:t}};var n=e.prototype;return n.reset=function(){this.updatedWithError=!1,this.setState(s)},n.componentDidCatch=function(t,e){var n,r;null==(n=(r=this.props).onError)||n.call(r,t,e)},n.componentDidMount=function(){null!==this.state.error&&(this.updatedWithError=!0)},n.componentDidUpdate=function(t){var e,n,r=this.state.error,i=this.props.resetKeys;null===r||this.updatedWithError?null!==r&&o(t.resetKeys,i)&&(null==(e=(n=this.props).onResetKeysChange)||e.call(n,t.resetKeys,i),this.reset()):this.updatedWithError=!0},n.render=function(){var t=this.state.error,e=this.props,n=e.fallbackRender,i=e.FallbackComponent,a=e.fallback;if(null!==t){var o={error:t,resetErrorBoundary:this.resetErrorBoundary};if(r.isValidElement(a))return a;if("function"==typeof n)return n(o);if(i)return r.createElement(i,o);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},e}(r.Component);function u(t,e){var n=function(n){return r.createElement(l,e,r.createElement(t,n))},i=t.displayName||t.name||"Unknown";return n.displayName="withErrorBoundary("+i+")",n}function c(t){var e=r.useState(null),n=e[0],i=e[1];if(null!=t)throw t;if(null!=n)throw n;return i}t.ErrorBoundary=l,t.useErrorHandler=c,t.withErrorBoundary=u,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(92437))},30665:function(t,e,n){"use strict";n.d(e,{ax:function(){return be},sP:function(){return Ce},CR:function(){return ze},P2:function(){return ke}});var r=n(3839);function i(){}function a(t){return null==t?i:function(){return this.querySelector(t)}}function o(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function s(){return[]}function l(t){return null==t?s:function(){return this.querySelectorAll(t)}}function u(t){return function(){return this.matches(t)}}function c(t){return function(e){return e.matches(t)}}var h=Array.prototype.find;function f(){return this.firstElementChild}var d=Array.prototype.filter;function p(){return Array.from(this.children)}function _(t){return new Array(t.length)}function m(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function y(t){return function(){return t}}function g(t,e,n,r,i,a){for(var o,s=0,l=e.length,u=a.length;s<u;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new m(t,a[s]);for(;s<l;++s)(o=e[s])&&(i[s]=o)}function v(t,e,n,r,i,a,o){var s,l,u,c=new Map,h=e.length,f=a.length,d=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(d[s]=u=o.call(l,l.__data__,s,e)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<f;++s)u=o.call(t,a[s],s,a)+"",(l=c.get(u))?(r[s]=l,l.__data__=a[s],c.delete(u)):n[s]=new m(t,a[s]);for(s=0;s<h;++s)(l=e[s])&&c.get(d[s])===l&&(i[s]=l)}function x(t){return t.__data__}function w(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function b(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}m.prototype={constructor:m,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var z="http://www.w3.org/1999/xhtml",k={svg:"http://www.w3.org/2000/svg",xhtml:z,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function A(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),k.hasOwnProperty(e)?{space:k[e],local:t}:t}function E(t){return function(){this.removeAttribute(t)}}function T(t){return function(){this.removeAttributeNS(t.space,t.local)}}function M(t,e){return function(){this.setAttribute(t,e)}}function S(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function N(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function O(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Z(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function C(t){return function(){this.style.removeProperty(t)}}function I(t,e,n){return function(){this.style.setProperty(t,e,n)}}function D(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function L(t,e){return t.style.getPropertyValue(e)||Z(t).getComputedStyle(t,null).getPropertyValue(e)}function B(t){return function(){delete this[t]}}function F(t,e){return function(){this[t]=e}}function P(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function q(t){return t.trim().split(/^|\s+/)}function U(t){return t.classList||new Y(t)}function Y(t){this._node=t,this._names=q(t.getAttribute("class")||"")}function R(t,e){for(var n=U(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function j(t,e){for(var n=U(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function H(t){return function(){R(this,t)}}function G(t){return function(){j(this,t)}}function V(t,e){return function(){(e.apply(this,arguments)?R:j)(this,t)}}function X(){this.textContent=""}function K(t){return function(){this.textContent=t}}function W(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function J(){this.innerHTML=""}function $(t){return function(){this.innerHTML=t}}function Q(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function tt(){this.nextSibling&&this.parentNode.appendChild(this)}function et(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function nt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===z&&e.documentElement.namespaceURI===z?e.createElement(t):e.createElementNS(n,t)}}function rt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function it(t){var e=A(t);return(e.local?rt:nt)(e)}function at(){return null}function ot(){var t=this.parentNode;t&&t.removeChild(this)}function st(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function lt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ut(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function ct(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function ht(t,e,n){return function(){var r,i=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var o=0,s=i.length;o<s;++o)if((r=i[o]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=e);this.addEventListener(t.type,a,n),r={type:t.type,name:t.name,value:e,listener:a,options:n},i?i.push(r):this.__on=[r]}}function ft(t,e,n){var r=Z(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function dt(t,e){return function(){return ft(this,t,e)}}function pt(t,e){return function(){return ft(this,t,e.apply(this,arguments))}}Y.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var _t=[null];function mt(t,e){this._groups=t,this._parents=e}function yt(){return new mt([[document.documentElement]],_t)}mt.prototype=yt.prototype={constructor:mt,select:function(t){"function"!=typeof t&&(t=a(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s,l=e[i],u=l.length,c=r[i]=new Array(u),h=0;h<u;++h)(o=l[h])&&(s=t.call(o,o.__data__,h,l))&&("__data__"in o&&(s.__data__=o.__data__),c[h]=s);return new mt(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return o(t.apply(this,arguments))}}(t):l(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var s,u=e[a],c=u.length,h=0;h<c;++h)(s=u[h])&&(r.push(t.call(s,s.__data__,h,u)),i.push(s));return new mt(r,i)},selectChild:function(t){return this.select(null==t?f:function(t){return function(){return h.call(this.children,t)}}("function"==typeof t?t:c(t)))},selectChildren:function(t){return this.selectAll(null==t?p:function(t){return function(){return d.call(this.children,t)}}("function"==typeof t?t:c(t)))},filter:function(t){"function"!=typeof t&&(t=u(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,l=r[i]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&l.push(a);return new mt(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,x);var n=e?v:g,r=this._parents,i=this._groups;"function"!=typeof t&&(t=y(t));for(var a=i.length,o=new Array(a),s=new Array(a),l=new Array(a),u=0;u<a;++u){var c=r[u],h=i[u],f=h.length,d=w(t.call(c,c&&c.__data__,u,r)),p=d.length,_=s[u]=new Array(p),m=o[u]=new Array(p),b=l[u]=new Array(f);n(c,h,_,m,b,d,e);for(var z,k,A=0,E=0;A<p;++A)if(z=_[A]){for(A>=E&&(E=A+1);!(k=m[E])&&++E<p;);z._next=k||null}}return(o=new mt(o,r))._enter=s,o._exit=l,o},enter:function(){return new mt(this._enter||this._groups.map(_),this._parents)},exit:function(){return new mt(this._exit||this._groups.map(_),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,a=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),l=0;l<o;++l)for(var u,c=n[l],h=r[l],f=c.length,d=s[l]=new Array(f),p=0;p<f;++p)(u=c[p]||h[p])&&(d[p]=u);for(;l<i;++l)s[l]=n[l];return new mt(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=b);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],l=s.length,u=i[a]=new Array(l),c=0;c<l;++c)(o=s[c])&&(u[c]=o);u.sort(e)}return new mt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=A(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?T:E:"function"==typeof e?n.local?O:N:n.local?S:M)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?C:"function"==typeof e?D:I)(t,e,null==n?"":n)):L(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?B:"function"==typeof e?P:F)(t,e)):this.node()[t]},classed:function(t,e){var n=q(t+"");if(arguments.length<2){for(var r=U(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?V:e?H:G)(n,e))},text:function(t){return arguments.length?this.each(null==t?X:("function"==typeof t?W:K)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?J:("function"==typeof t?Q:$)(t)):this.node().innerHTML},raise:function(){return this.each(tt)},lower:function(){return this.each(et)},append:function(t){var e="function"==typeof t?t:it(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:it(t),r=null==e?at:"function"==typeof e?e:a(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ot)},clone:function(t){return this.select(t?lt:st)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=ut(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?ht:ct,r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(r=0,l=s[u];r<o;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?pt:dt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],a=0,o=i.length;a<o;++a)(r=i[a])&&(yield r)}};var gt=yt;function vt(t){return"string"==typeof t?new mt([[document.querySelector(t)]],[document.documentElement]):new mt([[t]],_t)}const xt={capture:!0,passive:!1};function wt(t){t.preventDefault(),t.stopImmediatePropagation()}function bt(t){var e=t.document.documentElement,n=vt(t).on("dragstart.drag",wt,xt);"onselectstart"in e?n.on("selectstart.drag",wt,xt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function zt(t,e){var n=t.document.documentElement,r=vt(t).on("dragstart.drag",null);e&&(r.on("click.drag",wt,xt),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var kt=Math.SQRT2;function At(t){return((t=Math.exp(t))+1/t)/2}function Et(t,e){var n,r,i=t[0],a=t[1],o=t[2],s=e[0],l=e[1],u=e[2],c=s-i,h=l-a,f=c*c+h*h;if(f<1e-12)r=Math.log(u/o)/kt,n=function(t){return[i+t*c,a+t*h,o*Math.exp(kt*t*r)]};else{var d=Math.sqrt(f),p=(u*u-o*o+4*f)/(2*o*2*d),_=(u*u-o*o-4*f)/(2*u*2*d),m=Math.log(Math.sqrt(p*p+1)-p),y=Math.log(Math.sqrt(_*_+1)-_);r=(y-m)/kt,n=function(t){var e,n=t*r,s=At(m),l=o/(2*d)*(s*(e=kt*n+m,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(m));return[i+l*c,a+l*h,o*s/At(kt*n+m)]}}return n.duration=1e3*r,n}function Tt(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}var Mt=n(5540),St=n(49390),Nt=(0,r.Z)("start","end","cancel","interrupt"),Ot=[];function Zt(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}function o(a){var u,c,h,f;if(1!==n.state)return l();for(u in i)if((f=i[u]).name===n.name){if(3===f.state)return(0,St.Z)(o);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[u]):+u<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[u])}if((0,St.Z)((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(a))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=f);r.length=c+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=(0,Mt.HT)(a,0,n.time)}(t,n,{name:e,index:r,group:i,on:Nt,tween:Ot,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function Ct(t,e){var n=Dt(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function It(t,e){var n=Dt(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Dt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Lt(t,e){var n,r,i,a=t.__transition,o=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}}var Bt=n(78725);function Ft(t,e){var n,r;return function(){var i=It(this,t),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}i.tween=r}}function Pt(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=It(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=s;break}l===u&&i.push(s)}a.tween=i}}function qt(t,e,n){var r=t._id;return t.each((function(){var t=It(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Dt(t,r).value[e]}}var Ut=n(85959),Yt=n(30017),Rt=n(54684),jt=n(70906);function Ht(t,e){var n;return("number"==typeof e?Yt.Z:e instanceof Ut.ZP?Rt.ZP:(n=(0,Ut.ZP)(e))?(e=n,Rt.ZP):jt.Z)(t,e)}function Gt(t){return function(){this.removeAttribute(t)}}function Vt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Xt(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttribute(t);return o===a?null:o===r?i:i=e(r=o,n)}}function Kt(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===r?i:i=e(r=o,n)}}function Wt(t,e,n){var r,i,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(s=l+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,l));this.removeAttribute(t)}}function Jt(t,e,n){var r,i,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,l));this.removeAttributeNS(t.space,t.local)}}function $t(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Qt(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function te(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Qt(t,i)),n}return i._value=e,i}function ee(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&$t(t,i)),n}return i._value=e,i}function ne(t,e){return function(){Ct(this,t).delay=+e.apply(this,arguments)}}function re(t,e){return e=+e,function(){Ct(this,t).delay=e}}function ie(t,e){return function(){It(this,t).duration=+e.apply(this,arguments)}}function ae(t,e){return e=+e,function(){It(this,t).duration=e}}function oe(t,e){if("function"!=typeof e)throw new Error;return function(){It(this,t).ease=e}}function se(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Ct:It;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}var le=gt.prototype.constructor;function ue(t){return function(){this.style.removeProperty(t)}}function ce(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function he(t,e,n){var r,i;function a(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&ce(t,a,n)),r}return a._value=e,a}function fe(t){return function(e){this.textContent=t.call(this,e)}}function de(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&fe(r)),e}return r._value=t,r}var pe=0;function _e(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function me(){return++pe}var ye=gt.prototype;_e.prototype=function(t){return gt().transition(t)}.prototype={constructor:_e,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=a(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var l,u,c=r[s],h=c.length,f=o[s]=new Array(h),d=0;d<h;++d)(l=c[d])&&(u=t.call(l,l.__data__,d,c))&&("__data__"in l&&(u.__data__=l.__data__),f[d]=u,Zt(f[d],e,n,d,f,Dt(l,n)));return new _e(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=l(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var u,c=r[s],h=c.length,f=0;f<h;++f)if(u=c[f]){for(var d,p=t.call(u,u.__data__,f,c),_=Dt(u,n),m=0,y=p.length;m<y;++m)(d=p[m])&&Zt(d,e,n,m,p,_);a.push(p),o.push(u)}return new _e(a,o,e,n)},selectChild:ye.selectChild,selectChildren:ye.selectChildren,filter:function(t){"function"!=typeof t&&(t=u(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,l=r[i]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&l.push(a);return new _e(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l,u=e[s],c=n[s],h=u.length,f=o[s]=new Array(h),d=0;d<h;++d)(l=u[d]||c[d])&&(f[d]=l);for(;s<r;++s)o[s]=e[s];return new _e(o,this._parents,this._name,this._id)},selection:function(){return new le(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=me(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,u=0;u<l;++u)if(o=s[u]){var c=Dt(o,e);Zt(o,t,n,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new _e(r,this._parents,t,n)},call:ye.call,nodes:ye.nodes,node:ye.node,size:ye.size,empty:ye.empty,each:ye.each,on:function(t,e){var n=this._id;return arguments.length<2?Dt(this.node(),n).on.on(t):this.each(se(n,t,e))},attr:function(t,e){var n=A(t),r="transform"===n?Bt.w:Ht;return this.attrTween(t,"function"==typeof e?(n.local?Jt:Wt)(n,r,qt(this,"attr."+t,e)):null==e?(n.local?Vt:Gt)(n):(n.local?Kt:Xt)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=A(t);return this.tween(n,(r.local?te:ee)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Bt.Y:Ht;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=L(this,t),o=(this.style.removeProperty(t),L(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}(t,r)).on("end.style."+t,ue(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,a;return function(){var o=L(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=L(this,t)),o===l?null:o===r&&l===i?a:(i=l,a=e(r=o,s))}}(t,r,qt(this,"style."+t,e))).each(function(t,e){var n,r,i,a,o="style."+e,s="end."+o;return function(){var l=It(this,t),u=l.on,c=null==l.value[o]?a||(a=ue(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(s,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,a=n+"";return function(){var o=L(this,t);return o===a?null:o===r?i:i=e(r=o,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,he(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(qt(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,de(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Dt(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?Ft:Pt)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ne:re)(e,t)):Dt(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ie:ae)(e,t)):Dt(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(oe(e,t)):Dt(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;It(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(a,o){var s={value:o},l={value:function(){0==--i&&a()}};n.each((function(){var n=It(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e})),0===i&&a()}))},[Symbol.iterator]:ye[Symbol.iterator]};var ge={time:null,delay:0,duration:250,ease:n(56606).tw};function ve(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}gt.prototype.interrupt=function(t){return this.each((function(){Lt(this,t)}))},gt.prototype.transition=function(t){var e,n;t instanceof _e?(e=t._id,t=t._name):(e=me(),(n=ge).time=(0,Mt.zO)(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,u=0;u<l;++u)(o=s[u])&&Zt(o,t,e,u,s,n||ve(o,e));return new _e(r,this._parents,t,e)};var xe=t=>()=>t;function we(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function be(t,e,n){this.k=t,this.x=e,this.y=n}be.prototype={constructor:be,scale:function(t){return 1===t?this:new be(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new be(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ze=new be(1,0,0);function ke(t){for(;!t.__zoom;)if(!(t=t.parentNode))return ze;return t.__zoom}function Ae(t){t.stopImmediatePropagation()}function Ee(t){t.preventDefault(),t.stopImmediatePropagation()}function Te(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Me(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Se(){return this.__zoom||ze}function Ne(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Oe(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ze(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function Ce(){var t,e,n,i=Te,a=Me,o=Ze,s=Ne,l=Oe,u=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],h=250,f=Et,d=(0,r.Z)("start","zoom","end"),p=500,_=0,m=10;function y(t){t.property("__zoom",Se).on("wheel.zoom",k,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",E).filter(l).on("touchstart.zoom",T).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",S).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(t,e){return(e=Math.max(u[0],Math.min(u[1],e)))===t.k?t:new be(e,t.x,t.y)}function v(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new be(t.k,r,i)}function x(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,e,n,r){t.on("start.zoom",(function(){b(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){b(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,i=arguments,o=b(t,i).event(r),s=a.apply(t,i),l=null==n?x(s):"function"==typeof n?n.apply(t,i):n,u=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),c=t.__zoom,h="function"==typeof e?e.apply(t,i):e,d=f(c.invert(l).concat(u/c.k),h.invert(l).concat(u/h.k));return function(t){if(1===t)t=h;else{var e=d(t),n=u/e[2];t=new be(n,l[0]-e[0]*n,l[1]-e[1]*n)}o.zoom(null,t)}}))}function b(t,e,n){return!n&&t.__zooming||new z(t,e)}function z(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=a.apply(t,e),this.taps=0}function k(t,...e){if(i.apply(this,arguments)){var n=b(this,e).event(t),r=this.__zoom,a=Math.max(u[0],Math.min(u[1],r.k*Math.pow(2,s.apply(this,arguments)))),l=Tt(t);if(n.wheel)n.mouse[0][0]===l[0]&&n.mouse[0][1]===l[1]||(n.mouse[1]=r.invert(n.mouse[0]=l)),clearTimeout(n.wheel);else{if(r.k===a)return;n.mouse=[l,r.invert(l)],Lt(this),n.start()}Ee(t),n.wheel=setTimeout(h,150),n.zoom("mouse",o(v(g(r,a),n.mouse[0],n.mouse[1]),n.extent,c))}function h(){n.wheel=null,n.end()}}function A(t,...e){if(!n&&i.apply(this,arguments)){var r=t.currentTarget,a=b(this,e,!0).event(t),s=vt(t.view).on("mousemove.zoom",f,!0).on("mouseup.zoom",d,!0),l=Tt(t,r),u=t.clientX,h=t.clientY;bt(t.view),Ae(t),a.mouse=[l,this.__zoom.invert(l)],Lt(this),a.start()}function f(t){if(Ee(t),!a.moved){var e=t.clientX-u,n=t.clientY-h;a.moved=e*e+n*n>_}a.event(t).zoom("mouse",o(v(a.that.__zoom,a.mouse[0]=Tt(t,r),a.mouse[1]),a.extent,c))}function d(t){s.on("mousemove.zoom mouseup.zoom",null),zt(t.view,a.moved),Ee(t),a.event(t).end()}}function E(t,...e){if(i.apply(this,arguments)){var n=this.__zoom,r=Tt(t.changedTouches?t.changedTouches[0]:t,this),s=n.invert(r),l=n.k*(t.shiftKey?.5:2),u=o(v(g(n,l),r,s),a.apply(this,e),c);Ee(t),h>0?vt(this).transition().duration(h).call(w,u,r,t):vt(this).call(y.transform,u,r,t)}}function T(n,...r){if(i.apply(this,arguments)){var a,o,s,l,u=n.touches,c=u.length,h=b(this,r,n.changedTouches.length===c).event(n);for(Ae(n),o=0;o<c;++o)l=[l=Tt(s=u[o],this),this.__zoom.invert(l),s.identifier],h.touch0?h.touch1||h.touch0[2]===l[2]||(h.touch1=l,h.taps=0):(h.touch0=l,a=!0,h.taps=1+!!t);t&&(t=clearTimeout(t)),a&&(h.taps<2&&(e=l[0],t=setTimeout((function(){t=null}),p)),Lt(this),h.start())}}function M(t,...e){if(this.__zooming){var n,r,i,a,s=b(this,e).event(t),l=t.changedTouches,u=l.length;for(Ee(t),n=0;n<u;++n)i=Tt(r=l[n],this),s.touch0&&s.touch0[2]===r.identifier?s.touch0[0]=i:s.touch1&&s.touch1[2]===r.identifier&&(s.touch1[0]=i);if(r=s.that.__zoom,s.touch1){var h=s.touch0[0],f=s.touch0[1],d=s.touch1[0],p=s.touch1[1],_=(_=d[0]-h[0])*_+(_=d[1]-h[1])*_,m=(m=p[0]-f[0])*m+(m=p[1]-f[1])*m;r=g(r,Math.sqrt(_/m)),i=[(h[0]+d[0])/2,(h[1]+d[1])/2],a=[(f[0]+p[0])/2,(f[1]+p[1])/2]}else{if(!s.touch0)return;i=s.touch0[0],a=s.touch0[1]}s.zoom("touch",o(v(r,i,a),s.extent,c))}}function S(t,...r){if(this.__zooming){var i,a,o=b(this,r).event(t),s=t.changedTouches,l=s.length;for(Ae(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),p),i=0;i<l;++i)a=s[i],o.touch0&&o.touch0[2]===a.identifier?delete o.touch0:o.touch1&&o.touch1[2]===a.identifier&&delete o.touch1;if(o.touch1&&!o.touch0&&(o.touch0=o.touch1,delete o.touch1),o.touch0)o.touch0[1]=this.__zoom.invert(o.touch0[0]);else if(o.end(),2===o.taps&&(a=Tt(a,this),Math.hypot(e[0]-a[0],e[1]-a[1])<m)){var u=vt(this).on("dblclick.zoom");u&&u.apply(this,arguments)}}}return y.transform=function(t,e,n,r){var i=t.selection?t.selection():t;i.property("__zoom",Se),t!==i?w(t,e,n,r):i.interrupt().each((function(){b(this,arguments).event(r).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},y.scaleBy=function(t,e,n,r){y.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n,r)},y.scaleTo=function(t,e,n,r){y.transform(t,(function(){var t=a.apply(this,arguments),r=this.__zoom,i=null==n?x(t):"function"==typeof n?n.apply(this,arguments):n,s=r.invert(i),l="function"==typeof e?e.apply(this,arguments):e;return o(v(g(r,l),i,s),t,c)}),n,r)},y.translateBy=function(t,e,n,r){y.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),a.apply(this,arguments),c)}),null,r)},y.translateTo=function(t,e,n,r,i){y.transform(t,(function(){var t=a.apply(this,arguments),i=this.__zoom,s=null==r?x(t):"function"==typeof r?r.apply(this,arguments):r;return o(ze.translate(s[0],s[1]).scale(i.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,c)}),r,i)},z.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=vt(this.that).datum();d.call(t,this.that,new we(t,{sourceEvent:this.sourceEvent,target:y,type:t,transform:this.that.__zoom,dispatch:d}),e)}},y.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:xe(+t),y):s},y.filter=function(t){return arguments.length?(i="function"==typeof t?t:xe(!!t),y):i},y.touchable=function(t){return arguments.length?(l="function"==typeof t?t:xe(!!t),y):l},y.extent=function(t){return arguments.length?(a="function"==typeof t?t:xe([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),y):a},y.scaleExtent=function(t){return arguments.length?(u[0]=+t[0],u[1]=+t[1],y):[u[0],u[1]]},y.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],y):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},y.constrain=function(t){return arguments.length?(o=t,y):o},y.duration=function(t){return arguments.length?(h=+t,y):h},y.interpolate=function(t){return arguments.length?(f=t,y):f},y.on=function(){var t=d.on.apply(d,arguments);return t===d?y:t},y.clickDistance=function(t){return arguments.length?(_=(t=+t)*t,y):Math.sqrt(_)},y.tapDistance=function(t){return arguments.length?(m=+t,y):m},y}ke.prototype=be.prototype}}]);