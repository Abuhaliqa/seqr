"use strict";(self.webpackChunkseqr=self.webpackChunkseqr||[]).push([[543],{88239:function(t,e,n){n.d(e,{v:function(){return g}});var r=n(92437),a=n(66318),o=n.n(a),i=n(53417),l=n(90503);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}var h,b,y,g="https://gtexportal.org/rest/v1/",x=function(t){function e(){return u(this,e),p(this,d(e).apply(this,arguments))}var n,a,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(e,t),n=e,(a=[{key:"componentDidMount",value:function(){var t=this.props,e=t.geneId,n=t.launchGtex;new l.c("".concat(g,"reference/gene"),(function(t){n(t.gene[0].gencodeId)}),(function(){n(e)})).get({format:"json",geneId:e})}},{key:"render",value:function(){var t=this.props.containerId;return r.createElement(i.Z,{id:t})}}])&&c(n.prototype,a),o&&c(n,o),e}(r.PureComponent);h=x,b="propTypes",y={geneId:o().string.isRequired,containerId:o().string.isRequired,launchGtex:o().func.isRequired},b in h?Object.defineProperty(h,b,{value:y,enumerable:!0,configurable:!0,writable:!0}):h[b]=y,e.Z=x},49543:function(t,e,n){n.r(e),n.d(e,{default:function(){return k}});var r=n(92437),a=n(66318),o=n.n(a),i=n(65351),l=n(5130),s=n(80066),u=n(62366),c=n(77126),p=n(50352),d=n(1300),f=n(6939);class h{constructor(t,e=!0,n=10,r="boxplot-tooltip"){this.boxplotData=t.sort((function(t,e){return t.label<e.label?-1:t.label>e.label?1:0})),this.allVals=[],this.boxplotData.forEach((t=>{t.data.sort(i.j2),this.allVals=this.allVals.concat(t.data),t.q1=(0,i.VR)(t.data,.25),t.median=(0,i.C2)(t.data),t.q3=(0,i.VR)(t.data,.75),t.iqr=t.q3-t.q1,t.upperBound=(0,i.Fp)(t.data.filter((e=>e<=t.q3+1.5*t.iqr))),t.lowerBound=(0,i.VV)(t.data.filter((e=>e>=t.q1-1.5*t.iqr))),t.outliers=t.data.filter((e=>e<t.lowerBound||e>t.upperBound))})),this.useLog=e,this.logBase=n,this.allVals.sort(i.j2),this.tooltip=void 0,this.createTooltip(r)}render(t,e={}){let n=e.width||1200,r=e.height||800,a=e.marginTop||10,o=e.marginRight||70,i=e.marginBottom||150,s=e.marginLeft||40,u=e.padding||.15,c=e.xAxisFontSize||11,d=e.xAxisLabel||"",f=e.xAxisLabelFontSize||11,h=e.yAxisFontSize||10,b=(this.useLog?`log${this.logBase}(${e.yAxisUnit})`:e.yAxisUnit)||"",y=e.yAxisLabelFontSize||11;const g=this._getLogAdjustment(),x=this._createSvg(t,n,r).append("g").attr("id","gtex-viz-boxplot");let m=this._setScales(n-(s+o),r-(a+i),u),v=(0,p.LL)(m.x),w=(0,p.y4)(m.y);x.append("g").attr("class","boxplot-x-axis").attr("transform",`translate(${s+m.x.bandwidth()/2}, ${r-i})`).call(v).attr("text-anchor","start").selectAll("text").attr("transform","translate(5,1) rotate(45)").attr("font-size",c),x.append("text").attr("transform",`translate(${s+n/2+m.x.bandwidth()/2}, ${r-f/2})`).attr("text-anchor","middle").style("font-size",f).text(d),x.append("g").attr("class","boxplot-y-axis").attr("transform",`translate(${s}, ${a})`).call(w).attr("font-size",h),x.append("text").attr("transform",`translate(${y}, ${(r-i)/2}) rotate(270)`).attr("text-anchor","middle").style("font-size",y).text(b),x.append("g").attr("class","boxplot-iqr").attr("transform",`translate(${s+m.x.bandwidth()}, ${a})`).selectAll("rect").data(this.boxplotData).enter().append("rect").attr("x",(t=>m.x(t.label)-m.x.bandwidth()/2)).attr("y",(t=>this.useLog?m.y(t.q3+g):m.y(t.q3))).attr("width",(t=>m.x.bandwidth())).attr("height",(t=>this.useLog?m.y(t.q1+g)-m.y(t.q3+g):m.y(t.q1)-m.y(t.q3))).attr("fill",(t=>`#${t.color}`)).attr("stroke","#aaa").on("mouseover",((t,e,n)=>{let r=(0,l.Z)(n[e]);this.boxplotMouseover(t,r)})).on("mouseout",((t,e,n)=>{let r=(0,l.Z)(n[e]);this.boxplotMouseout(t,r)})),x.append("g").attr("class","boxplot-median").attr("transform",`translate(${s+m.x.bandwidth()}, ${a})`).selectAll("line").data(this.boxplotData).enter().append("line").attr("x1",(t=>m.x(t.label)-m.x.bandwidth()/2)).attr("y1",(t=>this.useLog?m.y(t.median+g):m.y(t.median))).attr("x2",(t=>m.x(t.label)+m.x.bandwidth()/2)).attr("y2",(t=>this.useLog?m.y(t.median+g):m.y(t.median))).attr("stroke","#000").attr("stroke-width",2);let j=x.append("g").attr("class","boxplot-whisker");j.append("g").attr("transform",`translate(${s+m.x.bandwidth()}, ${a})`).selectAll("line").data(this.boxplotData).enter().append("line").attr("x1",(t=>m.x(t.label))).attr("y1",(t=>this.useLog?m.y(t.q3+g):m.y(t.q3))).attr("x2",(t=>m.x(t.label))).attr("y2",(t=>this.useLog?m.y(t.upperBound+g):m.y(t.upperBound))).attr("stroke","#aaa"),j.append("g").attr("transform",`translate(${s+m.x.bandwidth()}, ${a})`).selectAll("line").data(this.boxplotData).enter().append("line").attr("x1",(t=>m.x(t.label)-m.x.bandwidth()/4)).attr("y1",(t=>this.useLog?m.y(t.upperBound+g):m.y(t.upperBound))).attr("x2",(t=>m.x(t.label)+m.x.bandwidth()/4)).attr("y2",(t=>this.useLog?m.y(t.upperBound+g):m.y(t.upperBound))).attr("stroke","#aaa"),j.append("g").attr("transform",`translate(${s+m.x.bandwidth()}, ${a})`).selectAll("line").data(this.boxplotData).enter().append("line").attr("x1",(t=>m.x(t.label))).attr("y1",(t=>this.useLog?m.y(t.q1+g):m.y(t.q1))).attr("x2",(t=>m.x(t.label))).attr("y2",(t=>this.useLog?m.y(t.lowerBound+g):m.y(t.lowerBound))).attr("stroke","#aaa"),j.append("g").attr("transform",`translate(${s+m.x.bandwidth()}, ${a})`).selectAll("line").data(this.boxplotData).enter().append("line").attr("x1",(t=>m.x(t.label)-m.x.bandwidth()/4)).attr("y1",(t=>this.useLog?m.y(t.lowerBound+g):m.y(t.lowerBound))).attr("x2",(t=>m.x(t.label)+m.x.bandwidth()/4)).attr("y2",(t=>this.useLog?m.y(t.lowerBound+g):m.y(t.lowerBound))).attr("stroke","#aaa"),x.append("g").attr("class","boxplot-outliers").attr("transform",`translate(${s+m.x.bandwidth()}, ${a})`).selectAll("g").data(this.boxplotData).enter().append("g").selectAll("circle").data((t=>t.outliers.map((e=>({label:t.label,val:e}))))).enter().append("circle").attr("cx",(t=>m.x(t.label))).attr("cy",(t=>this.useLog?m.y(t.val+g):m.y(t.val))).attr("r","2").attr("stroke","#aaa").attr("fill","none")}createTooltip(t){0==f(`#${t}`).length&&f("<div/>").attr("id",t).appendTo(f("body")),this.tooltip=new d.Z(t),(0,l.Z)(`#${t}`).attr("class","boxplot-tooltip")}boxplotMouseover(t,e){void 0!==this.tooltip&&this.tooltip.show(`${t.label}<br/>\n            ${this.useLog?"Log10(Median TPM)":"Median TPM"}: ${t.median.toPrecision(3)}<br/>\n            Number of Samples: ${t.data.length}`),e.classed("highlighted",!0)}boxplotMouseout(t,e){void 0!==this.tooltip&&this.tooltip.hide(),e.classed("highlighted",!1)}_createSvg(t,e,n){return(0,l.Z)(`#${t}`).append("svg").attr("width",e).attr("height",n)}_setScales(t,e,n=0){let r,a=(0,s.Z)().domain(this.boxplotData.map((t=>t.label))).range([0,t]).paddingInner(n);if(this.useLog){const t=this._getLogAdjustment();r=(0,u.Z)().domain((0,i.We)(this.allVals).map((e=>e+t))).range([e,0]).base(this.logBase)}else r=(0,c.Z)().domain((0,i.We)(this.allVals)).range([e,0]);return{x:a,y:r}}_getLogAdjustment(){return 1}}var b=n(90503),y=n(88239);function g(t){return function(t){if(Array.isArray(t))return M(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||j(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,l=!1;try{for(n=n.call(t);!(i=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);i=!0);}catch(t){l=!0,a=t}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}(t,e)||j(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,e){if(t){if("string"==typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(t,e):void 0}}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var O="gene-tissue-tpm-plot",$={WB:"Whole_Blood",F:"Cells_Cultured_fibroblasts",M:"Muscle_Skeletal",L:"Cells_EBV-transformed_lymphocytes"},L=Object.entries($).reduce((function(t,e){var n=w(e,2),r=n[0];return m({},t,v({},n[1],r))}),{}),A={WB:"Whole Blood",F:"Fibroblast",M:"Muscle",L:"Lymphocyte"},S={width:600,height:450,padding:.35,marginLeft:40,marginTop:0,marginBottom:100,xAxisFontSize:12,yAxisLabelFontSize:14,yAxisUnit:"TPM"},q=function(t,e){return function(n){var r=g(new Set(Object.values(e).map((function(t){return t.sampleTissueType})))),a=Object.entries(e).map((function(t){var e=w(t,2);return{label:e[0],data:[e[1].tpm]}})),o=560-80*(2*r.length+a.length);Promise.all([new b.c("".concat(y.v,"expression/geneExpression"),(function(t){a.push.apply(a,g(t.geneExpression.map((function(t){var e=t.data,n=t.tissueSiteDetailId;return{data:e,label:"*GTEx - ".concat(A[L[n]]),color:"efefef"}}))))}),(function(){})).get({tissueSiteDetailId:r.map((function(t){return $[t]})).join(","),gencodeId:n}),new b.c("/api/rna_seq_expression/gene/".concat(t,"/tissues/").concat(r.join(",")),(function(t){a.push.apply(a,g(Object.entries(t).map((function(t){var e=w(t,2),n=e[0];return{data:e[1],label:"*RDG - ".concat(A[n]),color:"efefef"}}))))}),(function(){})).get()]).then((function(){new h(a,!1).render(O,m({},S,{marginRight:o}))}))}},B=function(t){var e=t.geneId,n=t.tpms;return r.createElement(y.Z,{geneId:e,containerId:O,launchGtex:q(e,n)})};B.propTypes={geneId:o().string.isRequired,tpms:o().object};var k=B},62366:function(t,e,n){n.d(e,{Z:function(){return h}});var r=n(51725),a=n(21251);var o=n(3653),i=n(24228);function l(t){return Math.log(t)}function s(t){return Math.exp(t)}function u(t){return-Math.log(-t)}function c(t){return-Math.exp(-t)}function p(t){return isFinite(t)?+("1e"+t):t<0?0:t}function d(t){return function(e){return-t(-e)}}function f(t){var e,n,o=t(l,s),i=o.domain,f=10;function h(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(f),n=function(t){return 10===t?p:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(f),i()[0]<0?(e=d(e),n=d(n),t(u,c)):t(l,s),o}return o.base=function(t){return arguments.length?(f=+t,h()):f},o.domain=function(t){return arguments.length?(i(t),h()):i()},o.ticks=function(t){var a,o=i(),l=o[0],s=o[o.length-1];(a=s<l)&&(d=l,l=s,s=d);var u,c,p,d=e(l),h=e(s),b=null==t?10:+t,y=[];if(!(f%1)&&h-d<b){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(c=1,u=n(d);c<f;++c)if(!((p=u*c)<l)){if(p>s)break;y.push(p)}}else for(;d<=h;++d)for(c=f-1,u=n(d);c>=1;--c)if(!((p=u*c)<l)){if(p>s)break;y.push(p)}2*y.length<b&&(y=(0,r.ZP)(l,s,b))}else y=(0,r.ZP)(d,h,Math.min(h-d,b)).map(n);return a?y.reverse():y},o.tickFormat=function(t,r){if(null==r&&(r=10===f?".0e":","),"function"!=typeof r&&(r=(0,a.WU)(r)),t===1/0)return r;null==t&&(t=10);var i=Math.max(1,f*t/o.ticks().length);return function(t){var a=t/n(Math.round(e(t)));return a*f<f-.5&&(a*=f),a<=i?r(t):""}},o.nice=function(){return i(function(t,e){var n,r=0,a=(t=t.slice()).length-1,o=t[r],i=t[a];return i<o&&(n=r,r=a,a=n,n=o,o=i,i=n),t[r]=e.floor(o),t[a]=e.ceil(i),t}(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},o}function h(){var t=f((0,o.l4)()).domain([1,10]);return t.copy=function(){return(0,o.JG)(t,h()).base(t.base())},i.o.apply(t,arguments),t}}}]);