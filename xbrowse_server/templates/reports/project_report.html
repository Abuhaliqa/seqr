{% extends 'analysispage.html' %}
{% load x_extras %}
{% load static from staticfiles %}


{% block title %}<a href="{% url 'families' project.project_id %}">Project Report</a> &#187;
    <span>{{ family }}</span>{% endblock %}

{% block links %}
    Project: <a href="{% url 'project_home' project.project_id %}">{{ project }}</a>
{% endblock %}
{% block innercontent %}
    {% include 'javascript.html' %}
    {% include 'family_warnings.html' %}


<!-- data table imports -->
<script src="https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.10/css/jquery.dataTables.min.css"/>





<script>
/**
 * Gets data for status distribution plot
 */
function populateStatusDistPlotData(project_id){
	 var url = "/api/reports/project/"+project_id+"/families_status";
	 $.ajax({url: url, 
		 	success: function(result){
	     		var counts={};
		     	for (var k in result){
		     		if (result.hasOwnProperty(k)) {
		     			if (counts.hasOwnProperty(result[k])){
		     				counts[result[k]] +=1;
		     			} 
		     			else{
		     				counts[result[k]] =1;
		     			}
		     		}
		     	}
		     	var struct_for_plot=[["Status", "Number of families in this status", { role: "style" } ]];
		     	for (var count in counts){
		     		struct_for_plot.push([count,counts[count]]);
		     	}
		     	renderStatusDistChart(struct_for_plot);

		     },
		    async:false,
		    dataType : "json",    
	 });
}

</script>

<script>

//$(window).load(function() {
//    populateStatusDistPlotData("1kg");
    $('#familyVariantSummary').DataTable();
//});
	
</script>




  <div class="container">
	<div class="row">
  		<div class="col-sm-6">
  			<h4 class="section-header">Family status distribution</h4>
 
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>


	<script type="text/javascript"> 
	google.charts.load("current", {packages:['corechart']});
	google.charts.setOnLoadCallback(renderStatusDistPlotData("1kg"));
    function renderStatusDistChart(dataArray) {
    			var data = google.visualization.arrayToDataTable([
	        		["Status", "Number of families in this status" ],
	        		["Copper", 8.94],
	        		["Silver", 10.49],
	        		["Gold", 19.30],
	        		["Platinum", 21.45]
	      		]);
	      		
    			//var data=google.visualization.arrayToDataTable(dataArray);
	      		
	      		var view = new google.visualization.DataView(data);
	      		view.setColumns([0, 1,
	                       { calc: "stringify",
	                         sourceColumn: 1,
	                         type: "string",
	                         role: "annotation" }]);
	
	      		var options = {
	        		chartArea : { left: 0 },
	        		width: 550,
	        		height: 300,
	        		bar: {groupWidth: "95%"},
	        		legend: { position: "none" },
	      			};
	      		var statusDistChart = new google.visualization.ColumnChart(document.getElementById("columnchart_values"));
	      		statusDistChart.draw(view, options);
  			}


    renderStatusDistChart("Dd");
</script>


<div id="columnchart_values" style="width: 900px; height: 300px;"></div>


  			
   		</div>
  		<div class="col-sm-6">
  			<h4 class="section-header">Phenotype distribution</h4>
  			
  	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.setOnLoadCallback(drawChart2);
      function drawChart2() {
        var data = google.visualization.arrayToDataTable([
          ['Age', 'Weight'],
          [ 8,      12],
          [ 4,      5.5],
          [ 11,     14],
          [ 4,      5],
          [ 3,      3.5],
          [ 6.5,    7]
        ]);

        var options = {
          chartArea : { left: 0 },
          hAxis: {title: 'HPO Term', minValue: 0, maxValue: 15},
          vAxis: {title: 'individual', minValue: 0, maxValue: 15},
          width: 550,
          height: 300,
          legend: 'none'
        };

        var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));

        chart.draw(data, options);
      }
    </script>
    <div id="chart_div" style="width: 900px; height: 300px;"></div>

  			
  			
  		</div>
  	</div>
  	
  	<div class="row">
  		<div class="col-sm-12">
  			<h4 class="section-header">Discovered variants</h4>
        	<table id="familyVariantSummary" class="table table-hover">
            		<thead>
                	<tr>
                		<td><p>Family ID<p></td>
                		<td><p>Status<p></td>
                		<td><p>Chromosome<p></td>
                		<td><p>Position</p></td>
                		<td><p>Reference</p></td>
                		<td><p>Alternate</p></td>
                		<td><p>ExAC popmax</p></td>
                		<td><p>Genotype</p></td>
                	</tr>
                	</thead>
                	<tbody>
                	    <td><p>test<p></td>
                		<td><p>test<p></td>
                		<td><p>test<p></td>
                		<td><p>test</p></td>
                		<td><p>test</p></td>
                		<td><p>test</p></td>
                		<td><p>test</p></td>
                		<td><p>test</p></td>
                		
                	</tbody>
            </table>
        </div>
  	</div>
  </div>
</div>
{% endblock %}
